<!DOCTYPE html>
<html lang="en" data-theme="ocean" data-layout="modern">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=1024, initial-scale=0.8, minimum-scale=0.3, maximum-scale=3.0, user-scalable=yes" />
  <title>CV</title>
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* =========================================================
       ENHANCED LOADING SYSTEM AND ANIMATIONS
    ========================================================= */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      transition: all 0.5s ease;
    }

    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loading-content {
      text-align: center;
      color: white;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    .loading-text {
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 10px;
    }

    .loading-subtext {
      font-size: 14px;
      opacity: 0.8;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Enhanced Photo Editor Loading */
    .photo-modal .loading-state {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      border-radius: 20px;
    }

    .photo-modal .loading-state.hidden {
      display: none;
    }

    /* =========================================================
       MODERN GRADIENT THEME SYSTEM
    ========================================================= */
    :root {
      --bg: #f8fafc;
      --paper: #ffffff;
      --text: #1e293b;
      --text-light: #64748b;
      --text-muted: #94a3b8;
      --border: #e2e8f0;
      --shadow: rgba(0, 0, 0, 0.1);
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --sidebar-bg: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      --pill-bg: rgba(102, 126, 234, 0.1);
      --pill-border: rgba(102, 126, 234, 0.3);
    }

    /* Ocean Theme */
    [data-theme="ocean"] {
      --text: #0f172a;
      --text-light: #334155;
      --text-muted: #64748b;
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-accent: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --sidebar-bg: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      --pill-bg: rgba(79, 172, 254, 0.15);
      --pill-border: rgba(79, 172, 254, 0.4);
    }

    /* Sunset Theme */
    [data-theme="sunset"] {
      --text: #451a03;
      --text-light: #92400e;
      --text-muted: #d97706;
      --gradient-primary: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      --gradient-secondary: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      --gradient-accent: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      --sidebar-bg: linear-gradient(135deg, #fff8f5 0%, #fef2f2 100%);
      --pill-bg: rgba(250, 112, 154, 0.15);
      --pill-border: rgba(250, 112, 154, 0.4);
    }

    /* Forest Theme */
    [data-theme="forest"] {
      --text: #14532d;
      --text-light: #166534;
      --text-muted: #16a34a;
      --gradient-primary: linear-gradient(135deg, #134e5e 0%, #71b280 100%);
      --gradient-secondary: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      --gradient-accent: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
      --sidebar-bg: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
      --pill-bg: rgba(56, 239, 125, 0.15);
      --pill-border: rgba(56, 239, 125, 0.4);
    }

    /* Royal Theme */
    [data-theme="royal"] {
      --text: #312e81;
      --text-light: #4c1d95;
      --text-muted: #6d28d9;
      --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-accent: linear-gradient(135deg, #5ee7df 0%, #66a6ff 100%);
      --sidebar-bg: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
      --pill-bg: rgba(102, 126, 234, 0.15);
      --pill-border: rgba(102, 126, 234, 0.4);
    }

    /* Aurora Theme */
    [data-theme="aurora"] {
      --text: #701a75;
      --text-light: #a21caf;
      --text-muted: #c026d3;
      --gradient-primary: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
      --gradient-secondary: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      --gradient-accent: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
      --sidebar-bg: linear-gradient(135deg, #fdf4ff 0%, #fef7ff 100%);
      --pill-bg: rgba(161, 140, 209, 0.15);
      --pill-border: rgba(161, 140, 209, 0.4);
    }

    /* Cyber Theme */
    [data-theme="cyber"] {
      --text: #ffffff;
      --text-light: #e2e8f0;
      --text-muted: #94a3b8;
      --bg: #0f0c29;
      --paper: #1a1a2e;
      --border: #16213e;
      --gradient-primary: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
      --gradient-secondary: linear-gradient(135deg, #ff00cc 0%, #333399 100%);
      --gradient-accent: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
      --sidebar-bg: linear-gradient(135deg, #16213e 0%, #0f3460 100%);
      --pill-bg: rgba(0, 210, 255, 0.15);
      --pill-border: rgba(0, 210, 255, 0.4);
    }

    /* Midnight Theme */
    [data-theme="midnight"] {
      --text: #ffffff;
      --text-light: #cbd5e1;
      --text-muted: #94a3b8;
      --bg: #1e293b;
      --paper: #334155;
      --border: #475569;
      --gradient-primary: linear-gradient(135deg, #232526 0%, #414345 100%);
      --gradient-secondary: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      --gradient-accent: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      --sidebar-bg: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      --pill-bg: rgba(131, 96, 195, 0.15);
      --pill-border: rgba(131, 96, 195, 0.4);
    }

    /* Coral Theme */
    [data-theme="coral"] {
      --text: #be123c;
      --text-light: #e11d48;
      --text-muted: #f43f5e;
      --gradient-primary: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      --gradient-secondary: linear-gradient(135deg, #ffc3a0 0%, #ffafbd 100%);
      --gradient-accent: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%);
      --sidebar-bg: linear-gradient(135deg, #fff5f5 0%, #fef2f2 100%);
      --pill-bg: rgba(255, 154, 158, 0.15);
      --pill-border: rgba(255, 154, 158, 0.4);
    }

    /* Emerald Theme */
    [data-theme="emerald"] {
      --text: #064e3b;
      --text-light: #065f46;
      --text-muted: #047857;
      --gradient-primary: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      --gradient-secondary: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
      --gradient-accent: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --sidebar-bg: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      --pill-bg: rgba(17, 153, 142, 0.15);
      --pill-border: rgba(17, 153, 142, 0.4);
    }

    /* Golden Theme */
    [data-theme="golden"] {
      --text: #92400e;
      --text-light: #d97706;
      --text-muted: #f59e0b;
      --gradient-primary: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
      --gradient-secondary: linear-gradient(135deg, #ff8008 0%, #ffc837 100%);
      --gradient-accent: linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%);
      --sidebar-bg: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
      --pill-bg: rgba(247, 151, 30, 0.15);
      --pill-border: rgba(247, 151, 30, 0.4);
    }

    /* Lavender Theme */
    [data-theme="lavender"] {
      --text: #581c87;
      --text-light: #7c3aed;
      --text-muted: #8b5cf6;
      --gradient-primary: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%);
      --gradient-secondary: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      --gradient-accent: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --sidebar-bg: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
      --pill-bg: rgba(224, 195, 252, 0.15);
      --pill-border: rgba(224, 195, 252, 0.4);
    }

    /* Monochrome Theme */
    [data-theme="monochrome"] {
      --text: #374151;
      --text-light: #6b7280;
      --text-muted: #9ca3af;
      --gradient-primary: linear-gradient(135deg, #434343 0%, #000000 100%);
      --gradient-secondary: linear-gradient(135deg, #bdc3c7 0%, #2c3e50 100%);
      --gradient-accent: linear-gradient(135deg, #757f9a 0%, #d7dde8 100%);
      --sidebar-bg: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      --pill-bg: rgba(67, 67, 67, 0.15);
      --pill-border: rgba(67, 67, 67, 0.4);
    }

    /* Neon Theme */
    [data-theme="neon"] {
      --text: #831843;
      --text-light: #be185d;
      --text-muted: #ec4899;
      --gradient-primary: linear-gradient(135deg, #ff006e 0%, #8338ec 100%);
      --gradient-secondary: linear-gradient(135deg, #3a86ff 0%, #06ffa5 100%);
      --gradient-accent: linear-gradient(135deg, #ffbe0b 0%, #fb5607 100%);
      --sidebar-bg: linear-gradient(135deg, #faf5ff 0%, #f0f9ff 100%);
      --pill-bg: rgba(255, 0, 110, 0.15);
      --pill-border: rgba(255, 0, 110, 0.4);
    }

    /* Executive Dark Theme */
    [data-theme="executive"] {
      --text: #f8fafc;
      --text-light: #e2e8f0;
      --text-muted: #cbd5e1;
      --bg: #0f172a;
      --paper: #1e293b;
      --border: #334155;
      --gradient-primary: linear-gradient(135deg, #1f2937 0%, #374151 100%);
      --gradient-secondary: linear-gradient(135deg, #111827 0%, #1f2937 100%);
      --gradient-accent: linear-gradient(135deg, #4b5563 0%, #6b7280 100%);
      --sidebar-bg: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      --pill-bg: rgba(75, 85, 99, 0.3);
      --pill-border: rgba(75, 85, 99, 0.6);
    }

    /* Charcoal Professional Theme */
    [data-theme="charcoal"] {
      --text: #f7fafc;
      --text-light: #e2e8f0;
      --text-muted: #cbd5e1;
      --bg: #171923;
      --paper: #2d3748;
      --border: #4a5568;
      --gradient-primary: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
      --gradient-secondary: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
      --gradient-accent: linear-gradient(135deg, #718096 0%, #a0aec0 100%);
      --sidebar-bg: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
      --pill-bg: rgba(113, 128, 150, 0.3);
      --pill-border: rgba(113, 128, 150, 0.6);
    }

    /* Steel Blue Theme */
    [data-theme="steel"] {
      --text: #f1f5f9;
      --text-light: #cbd5e1;
      --text-muted: #94a3b8;
      --bg: #0f172a;
      --paper: #334155;
      --border: #475569;
      --gradient-primary: linear-gradient(135deg, #334155 0%, #475569 100%);
      --gradient-secondary: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      --gradient-accent: linear-gradient(135deg, #64748b 0%, #94a3b8 100%);
      --sidebar-bg: linear-gradient(135deg, #334155 0%, #475569 100%);
      --pill-bg: rgba(100, 116, 139, 0.3);
      --pill-border: rgba(100, 116, 139, 0.6);
    }

    /* Masculine Bronze Theme */
    [data-theme="bronze"] {
      --text: #faf5f0;
      --text-light: #e2d5ca;
      --text-muted: #c4a484;
      --bg: #1a0e0a;
      --paper: #2d1b13;
      --border: #5d2f02;
      --gradient-primary: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
      --gradient-secondary: linear-gradient(135deg, #5d2f02 0%, #8b4513 100%);
      --gradient-accent: linear-gradient(135deg, #cd853f 0%, #daa520 100%);
      --sidebar-bg: linear-gradient(135deg, #2d1b13 0%, #5d2f02 100%);
      --pill-bg: rgba(139, 69, 19, 0.4);
      --pill-border: rgba(139, 69, 19, 0.7);
    }

    /* Deep Navy Theme */
    [data-theme="navy"] {
      --text: #f1f5f9;
      --text-light: #cbd5e1;
      --text-muted: #94a3b8;
      --bg: #0c1527;
      --paper: #1e3a8a;
      --border: #3b82f6;
      --gradient-primary: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      --gradient-secondary: linear-gradient(135deg, #1e293b 0%, #1e3a8a 100%);
      --gradient-accent: linear-gradient(135deg, #60a5fa 0%, #93c5fd 100%);
      --sidebar-bg: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      --pill-bg: rgba(59, 130, 246, 0.3);
      --pill-border: rgba(59, 130, 246, 0.6);
    }

    /* Carbon Black Theme */
    [data-theme="carbon"] {
      --text: #fafafa;
      --text-light: #d4d4d8;
      --text-muted: #a1a1aa;
      --bg: #000000;
      --paper: #18181b;
      --border: #27272a;
      --gradient-primary: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      --gradient-secondary: linear-gradient(135deg, #09090b 0%, #18181b 100%);
      --gradient-accent: linear-gradient(135deg, #52525b 0%, #71717a 100%);
      --sidebar-bg: linear-gradient(135deg, #18181b 0%, #27272a 100%);
      --pill-bg: rgba(82, 82, 91, 0.3);
      --pill-border: rgba(82, 82, 91, 0.6);
    }

    /* Military Green Theme */
    [data-theme="military"] {
      --text: #f7fee7;
      --text-light: #d9f99d;
      --text-muted: #bef264;
      --bg: #0a0f02;
      --paper: #365314;
      --border: #4d7c0f;
      --gradient-primary: linear-gradient(135deg, #365314 0%, #4d7c0f 100%);
      --gradient-secondary: linear-gradient(135deg, #1a2e05 0%, #365314 100%);
      --gradient-accent: linear-gradient(135deg, #65a30d 0%, #84cc16 100%);
      --sidebar-bg: linear-gradient(135deg, #365314 0%, #4d7c0f 100%);
      --pill-bg: rgba(101, 163, 13, 0.3);
      --pill-border: rgba(101, 163, 13, 0.6);
    }

    /* Burgundy Professional Theme */
    [data-theme="burgundy"] {
      --text: #fef2f2;
      --text-light: #fecaca;
      --text-muted: #fca5a5;
      --bg: #1c0505;
      --paper: #7f1d1d;
      --border: #991b1b;
      --gradient-primary: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
      --gradient-secondary: linear-gradient(135deg, #450a0a 0%, #7f1d1d 100%);
      --gradient-accent: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
      --sidebar-bg: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);
      --pill-bg: rgba(220, 38, 38, 0.3);
      --pill-border: rgba(220, 38, 38, 0.6);
    }

    /* ...existing layout and style code... */

    /* PHOTO CROPPER MODAL */
    .photo-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(5px);
    }

    .photo-modal.active {
      display: flex;
    }

    .crop-container {
      background: white;
      border-radius: 12px;
      padding: 0;
      max-width: 800px;
      width: 80%;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
      display: grid;
      grid-template-columns: 1fr 250px;
      position: relative;
    }

    .crop-sidebar {
      background: #1f2937;
      color: white;
      padding: 0;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .sidebar-header {
      background: #111827;
      padding: 16px;
      text-align: center;
      border-bottom: 1px solid #374151;
    }

    .sidebar-title {
      font-size: 14px;
      font-weight: 600;
      color: #f9fafb;
      margin: 0;
    }

    .sidebar-section {
      padding: 16px;
      border-bottom: 1px solid #374151;
    }

    .sidebar-section:last-child {
      border-bottom: none;
    }

    .section-title {
      font-size: 12px;
      font-weight: 600;
      color: #9ca3af;
      margin: 0 0 12px 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .preview-container {
      width: 80px;
      height: 80px;
      border: 2px solid #374151;
      border-radius: 8px;
      overflow: hidden;
      background: #111827;
      margin: 0 auto 8px;
    }

    .shape-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }

    .shape-option {
      width: 35px;
      height: 35px;
      border: 1px solid #374151;
      cursor: pointer;
      background: #374151;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 8px;
      color: #9ca3af;
      transition: all 0.2s ease;
    }

    .shape-option:hover {
      background: #4b5563;
      border-color: #667eea;
    }

    .shape-option.active {
      background: #667eea;
      border-color: #667eea;
      color: white;
    }

    .crop-main-area {
      background: #f8fafc;
      padding: 20px;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .crop-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e5e7eb;
    }

    .crop-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
      font-family: 'Outfit', sans-serif;
    }

    .crop-close {
      width: 32px;
      height: 32px;
      border: none;
      background: #ef4444;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .crop-area {
      flex: 1;
      background: white;
      border: 2px dashed #cbd5e1;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 300px;
      position: relative;
      overflow: hidden;
    }
  

    .crop-workspace {
      display: grid;
      grid-template-columns: 1fr 200px;
      gap: 20px;
      margin-bottom: 20px;
    }

    .crop-area {
      position: relative;
      width: 100%;
      height: 400px;
      border: 2px dashed var(--border);
      border-radius: 12px;
      overflow: hidden;
      background: #f8fafc;
    }

    .crop-image {
      position: absolute;
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      cursor: move;
      user-select: none;
      transform-origin: center;
      object-fit: contain;
    }

    .crop-preview {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .preview-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      font-family: 'Outfit', sans-serif;
    }

    .preview-container {
      position: relative;
      width: 60px;
      height: 60px;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      background: white;
      margin: 0 auto;
    }

    .preview-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .shape-selector {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .shape-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .shape-option {
      width: 25px;
      height: 25px;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      background: var(--paper);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 8px;
      color: var(--text-light);
    }

    .shape-option:hover {
      border-color: var(--text);
    }

    .shape-option.active {
      border-color: var(--text);
      background: var(--gradient-primary);
      color: white;
    }

    .shape-option.square {
      border-radius: 4px;
    }

    .shape-option.circle {
      border-radius: 50%;
    }

    .shape-option.rounded {
      border-radius: 12px;
    }

    .shape-option.hexagon {
      border-radius: 4px;
      clip-path: polygon(30% 0%, 70% 0%, 100% 50%, 70% 100%, 30% 100%, 0% 50%);
    }

    .crop-controls {
      background: white;
      border-radius: 12px;
      padding: 16px;
      border: 1px solid #e5e7eb;
    }

    .controls-header {
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
      margin: 0 0 12px 0;
      text-align: center;
    }

    .controls-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .control-label {
      font-size: 10px;
      font-weight: 600;
      color: var(--text);
      font-family: 'Outfit', sans-serif;
    }

    .control-slider {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: linear-gradient(90deg, #e5e7eb 0%, #667eea 100%);
      outline: none;
      appearance: none;
      cursor: pointer;
    }

    .control-slider::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .control-slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .rotation-controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .rotate-btn {
      width: 20px;
      height: 20px;
      border: 1px solid var(--border);
      border-radius: 4px;
      background: var(--paper);
      color: var(--text);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      transition: all 0.3s ease;
    }

    .rotate-btn:hover {
      background: var(--gradient-primary);
      color: white;
    }

    .crop-actions {
      background: #111827;
      padding: 16px;
      display: flex;
      gap: 8px;
      border-top: 1px solid #374151;
    }

    .crop-btn {
      flex: 1;
      padding: 10px 16px;
      border: 1px solid #374151;
      border-radius: 6px;
      background: #374151;
      color: #d1d5db;
      font-weight: 500;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .crop-btn:hover {
      background: #4b5563;
      border-color: #667eea;
    }

    .crop-btn.primary {
      background: #667eea;
      border-color: #667eea;
      color: white;
    }

    .crop-btn.primary:hover {
      background: #5b6dd1;
    }

    /* Enhanced Photo Editor Styles */
    .enhancement-section {
      background: white;
      border-radius: 12px;
      padding: 16px;
      border: 1px solid #e5e7eb;
    }

    .enhancement-section h4 {
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
      margin: 0 0 12px 0;
      text-align: center;
    }

    .filter-presets {
      margin-top: 0;
    }

    .preset-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 0;
    }

    .preset-btn {
      padding: 2px 4px;
      border: 1px solid var(--border);
      border-radius: 3px;
      background: var(--paper);
      color: var(--text);
      font-size: 7px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .preset-btn:hover {
      background: var(--gradient-primary);
      color: white;
      transform: translateY(-1px);
    }

    .preset-btn.active {
      background: var(--gradient-accent);
      color: white;
      border-color: transparent;
    }

    /* Advanced Control Animations */
    .control-slider {
      background: linear-gradient(to right, var(--gradient-primary), var(--gradient-secondary));
      background-size: 200% 100%;
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .control-slider:focus {
      animation: none;
      background: var(--gradient-accent);
    }

    /* ...rest of existing styles... */
    
    /* =========================================================
       LAYOUT SYSTEM
    ========================================================= */
    
    /* Modern Layout (Default) */
    [data-layout="modern"] .cv {
      display: grid;
      grid-template-columns: 65mm 1fr;
      min-height: 287mm;
    }

    /* Compact Layout */
    [data-layout="compact"] .cv {
      display: grid;
      grid-template-columns: 55mm 1fr;
      min-height: 287mm;
    }

    /* Centered Layout */
    [data-layout="centered"] .cv {
      display: block;
    }

    [data-layout="centered"] .sidebar {
      width: 100%;
      border-right: none;
      border-bottom: 1px solid var(--border);
      padding: 8mm 15mm;
      text-align: center;
    }

    [data-layout="centered"] .main-content {
      padding: 12mm 15mm;
    }

    /* Executive Layout */
    [data-layout="executive"] .cv {
      display: grid;
      grid-template-columns: 75mm 1fr;
      min-height: 287mm;
    }

    /* Minimal Layout */
    [data-layout="minimal"] .cv {
      display: block;
    }

    [data-layout="minimal"] .sidebar {
      display: none;
    }

    /* Show name and title at top for minimal layout */
    [data-layout="minimal"] .minimal-header {
      display: block !important;
      text-align: center;
      margin-bottom: 20mm;
      padding-bottom: 10mm;
      border-bottom: 2px solid var(--gradient-primary);
    }

    [data-layout="minimal"] .minimal-header .name {
      font-size: 24px;
      font-weight: 800;
      margin: 0 0 5mm 0;
      color: var(--text);
    }

    [data-layout="minimal"] .minimal-header .title {
      font-size: 16px;
      font-weight: 600;
      margin: 0;
      color: var(--text-light);
    }

    [data-layout="minimal"] .main-content {
      padding: 15mm 20mm;
    }

    [data-layout="minimal"] .contact-inline {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 5mm 0;
      flex-wrap: wrap;
    }

    /* Two Column Layout */
    [data-layout="two-column"] .cv {
      display: grid;
      grid-template-columns: 1fr 1fr;
      min-height: 287mm;
    }

    [data-layout="two-column"] .sidebar {
      border-right: 1px solid var(--border);
      padding: 15mm 10mm;
    }

    /* Split Layout */
    [data-layout="split"] .cv {
      display: grid;
      grid-template-columns: 1fr 50mm 1fr;
      min-height: 287mm;
    }

    [data-layout="split"] .sidebar {
      border-left: 1px solid var(--border);
      border-right: 1px solid var(--border);
      padding: 15mm 8mm;
      text-align: center;
    }

    /* Creative Layout */
    [data-layout="creative"] .cv {
      display: grid;
      grid-template-columns: 80mm 1fr;
      min-height: 287mm;
      transform: skew(-2deg);
      overflow: hidden;
    }

    [data-layout="creative"] .sidebar {
      transform: skew(2deg);
      background: var(--gradient-primary);
      color: white;
      padding: 20mm 12mm;
    }

    [data-layout="creative"] .main-content {
      transform: skew(2deg);
      padding: 15mm 20mm;
    }

    /* Timeline Layout */
    [data-layout="timeline"] .cv {
      display: block;
    }

    [data-layout="timeline"] .sidebar {
      width: 100%;
      border-right: none;
      border-bottom: 3px solid var(--gradient-primary);
      padding: 8mm 15mm;
      text-align: center;
      background: var(--gradient-primary);
      color: white;
    }

    [data-layout="timeline"] .main-content {
      padding: 12mm 15mm;
    }

    /* Magazine Layout */
    [data-layout="magazine"] .cv {
      display: grid;
      grid-template-columns: 1fr 2fr;
      min-height: 287mm;
    }

    [data-layout="magazine"] .sidebar {
      border-right: 3px solid var(--gradient-primary);
      padding: 20mm 15mm;
      background: linear-gradient(135deg, var(--sidebar-bg), var(--paper));
    }

    /* Grid Layout */
    [data-layout="grid"] .cv {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10mm;
      min-height: 287mm;
    }

    [data-layout="grid"] .sidebar {
      grid-column: 1;
      border: none;
      border-radius: 15px;
      margin: 10mm;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    [data-layout="grid"] .main-content {
      grid-column: 2 / 4;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8mm;
    }

    /* =========================================================
       BASE STYLES
    ========================================================= */
  /* === Redesigned Photo Editor Shell Overrides === */
  /* Enhanced unified editor styles */
  .unified-editor {
    position: relative;
    overflow: hidden;
  }
  
  .canvas-image.live-preview {
    display: block;
    max-width: none;
    max-height: none;
    transition: all 0.1s ease;
  }
  
  .shape-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 200px;
    height: 200px;
    border: 3px solid rgba(255, 255, 255, 0.8);
    border-radius: 8px;
    pointer-events: none;
    z-index: 10;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
  }
  
  .shape-overlay.circle {
    border-radius: 50%;
  }
  
  .shape-overlay.rounded {
    border-radius: 20px;
  }
  
  .shape-overlay.hexagon {
    border-radius: 0;
    clip-path: polygon(30% 0%, 70% 0%, 100% 50%, 70% 100%, 30% 100%, 0% 50%);
  }
  
  .shape-section {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
  }
  
  .shape-section .sec-heading {
    color: #fff;
    font-weight: 600;
    margin-bottom: 10px;
    font-size: 14px;
  }

  .editor-shell { display:grid; grid-template-columns:1fr 350px; height:70vh; width:70vw; margin:15vh auto; position:fixed; top:0; left:50%; transform:translateX(-50%); z-index:9999; }
  .editor-canvas-panel { display:flex; flex-direction:column; padding:15px 20px 12px; }
  .editor-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
  .editor-title { margin:0; font-size:18px; font-weight:700; font-family:'Outfit',sans-serif; color:var(--text); }
  .editor-close { width:36px; height:36px; background:#ef4444; color:#fff; border:none; border-radius:8px; font-size:18px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
  .editor-close:hover { background:#dc2626; }
  .canvas-wrapper { flex:1; position:relative; display:flex; flex-direction:column; gap:12px; }
  .canvas-area { flex:1; min-height:calc(70vh - 200px); background:repeating-conic-gradient(from 45deg,#f8fafc 0deg,#f8fafc 15deg,#f1f5f9 15deg,#f1f5f9 30deg); border:2px dashed var(--border); border-radius:10px; position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center; }
  .canvas-image { position:absolute; max-width:100%; max-height:100%; cursor:move; user-select:none; }
  .quick-bar { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; background:#ffffff; padding:12px 14px; border:1px solid var(--border); border-radius:10px; box-shadow:0 4px 18px rgba(0,0,0,.05); }
  .quick-item label { display:flex; justify-content:space-between; font-size:12px; font-weight:600; margin-bottom:5px; color:var(--text-light); }
  .quick-item input[type=range] { width:100%; }
  .rotate-row { display:flex; align-items:center; gap:6px; }
  .rotate-row input[type=range]{ flex:1; }
  .mini-btn { width:28px; height:28px; border:1px solid var(--border); background:#fff; border-radius:6px; cursor:pointer; font-size:15px; display:flex; align-items:center; justify-content:center; }
  .mini-btn:hover { background:var(--gradient-primary); color:#fff; border-color:transparent; }
  .actions-bar { display:flex; gap:8px; justify-content:flex-end; padding-top:10px; border-top:1px solid var(--border); margin-top:10px; }
  .action-btn { padding:8px 16px; border:1px solid var(--border); background:#ffffff; border-radius:8px; font-weight:600; font-size:12px; cursor:pointer; font-family:'Outfit',sans-serif; }
  .action-btn:hover { background:var(--gradient-primary); color:#fff; border-color:transparent; }
  .action-btn.primary { background:var(--gradient-primary); color:#fff; border-color:transparent; }
  .editor-sidebar { background:linear-gradient(180deg,#0f172a,#1e293b); color:#fff; padding:15px 18px; display:flex; flex-direction:column; overflow:hidden; height:70vh; }
  .sidebar-scroll { overflow-y:auto; scrollbar-width:thin; display:flex; flex-direction:column; gap:14px; flex:1 1 auto; padding-right:4px; }
  .side-section { background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); padding:10px 12px; border-radius:8px; box-shadow:0 4px 18px rgba(0,0,0,.25); }
  .side-section.preview-section { text-align:center; }
  .sec-heading { margin:0 0 8px; font-size:11px; font-weight:700; letter-spacing:.5px; text-transform:uppercase; color:#cbd5e1; }
  .preview-box { width:150px; height:150px; margin:0 auto 10px; border:2px solid rgba(255,255,255,.15); border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#0f172a; }
  .preview-box canvas { width:100%; height:100%; object-fit:cover; }
  .shapes-row { display:grid; grid-template-columns:repeat(4,1fr); gap:5px; }
  .shape-btn { height:28px; border:1px solid rgba(255,255,255,.15); background:rgba(255,255,255,0.05); color:#94a3b8; border-radius:6px; font-size:13px; cursor:pointer; }
  .shape-btn.active,.shape-btn:hover { background:var(--gradient-primary); color:#fff; border-color:transparent; }
  .collapse-toggle { width:100%; text-align:left; background:rgba(255,255,255,0.07); border:1px solid rgba(255,255,255,0.12); color:#e2e8f0; padding:6px 8px; border-radius:6px; font-weight:600; font-size:11px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; }
  .collapse-toggle::after { content:'▾'; font-size:10px; opacity:.7; }
  .side-section.collapsed .collapse-toggle::after { content:'▸'; }
  .section-body { margin-top:8px; display:flex; flex-direction:column; gap:8px; }
  .side-section.collapsed .section-body { display:none; }
  .slider-label { display:flex; flex-direction:column; gap:3px; font-size:10px; font-weight:500; color:#cbd5e1; }
  .slider-label input[type=range] { width:100%; }
  .checkbox-label { display:flex; align-items:center; gap:5px; font-size:10px; color:#cbd5e1; font-weight:500; }
  .filters-grid { display:grid; grid-template-columns:1fr 1fr; gap:5px; }
  .filter-chip { padding:5px 7px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.15); color:#94a3b8; font-size:9px; border-radius:6px; cursor:pointer; font-weight:600; }
  .filter-chip:hover,.filter-chip.active { background:var(--gradient-accent); color:#fff; border-color:transparent; }
  /* Desktop layout maintained for all screen sizes */
  /* End redesigned shell */
    * { 
      box-sizing: border-box; 
    }
    
    /* Force desktop layout on all devices */
    body {
      min-width: 1200px !important;
      overflow-x: auto;
    }
    
    #app {
      min-width: 1200px !important;
      overflow-x: visible;
    }
    
    .cv {
      min-width: 280mm !important;
    }
    
    /* Ensure animations and transitions work on all screen sizes */
    * {
      animation-play-state: running !important;
    }
    
    /* Preserve all transitions and transforms */
    .cv,
    .paper,
    .btn,
    .photo,
    .skill-pill,
    .theme-card,
    .layout-card,
    .selector-label,
    .remove-btn,
    .crop-btn,
    .action-btn,
    .shape-option,
    .preset-btn,
    .rotate-btn,
    .selector-window,
    .window-backdrop,
    .loading-overlay {
      transition: all 0.3s ease !important;
    }
    
    /* Keep hover transforms working */
    .btn:hover {
      transform: translateY(-2px) !important;
    }
    
    .photo:hover {
      transform: scale(1.02) rotate(2deg) !important;
    }
    
    .skill-pill:hover {
      transform: translateY(-2px) !important;
    }
    
    .theme-card:hover,
    .layout-card:hover {
      transform: translateY(-4px) scale(1.02) !important;
    }
    
    /* Layout change animations */
    .cv {
      transition: all 0.5s ease !important;
    }
    
    .sidebar {
      transition: all 0.4s ease !important;
    }
    
    .main-content {
      transition: all 0.4s ease !important;
    }
    
    .section {
      transition: all 0.3s ease !important;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      line-height: 1.5;
    }

    #app {
      max-width: 280mm;
      margin: 20px auto;
      padding: 0 15px;
    }

    /* =========================================================
       MODERN CONTROLS
    ========================================================= */
    #controls {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding:  20px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 5px;
      flex-wrap: wrap;
      box-shadow: 0 8px 32px var(--shadow);
      width: calc(290mm - 30px);
      max-width: calc(290mm - 30px);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--paper);
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      font-family: 'Outfit', sans-serif;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px var(--shadow);
      border-color: transparent;
      background: var(--gradient-primary);
      color: white;
    }

    .btn.primary {
      background: var(--gradient-primary);
      color: white;
      border-color: transparent;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .btn.primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
    }

    .btn.danger {
      background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
      color: white;
      border-color: transparent;
    }

    .btn.small {
      padding: 6px 10px;
      font-size: 11px;
    }

    /* Theme & Layout Selectors */
    .selector-group {
      display: flex;
      align-items: center;
      gap: 12px;
      position: relative;
    }

    .selector-label {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
      color: white;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      font-size: 18px;
      box-shadow: 0 4px 15px rgba(107, 114, 128, 0.3);
      border: 2px solid transparent;
    }

    .selector-label:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .selector-label.active {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
    }

    .selector-window {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      padding: 24px;
      z-index: 1000;
      min-width: 400px;
      max-width: 90vw;
      max-height: 80vh;
      overflow-y: auto;
      opacity: 0;
      visibility: hidden;
      transform: translate(-50%, -50%) scale(0.9);
      transition: all 0.3s ease;
    }

    .selector-window.active {
      opacity: 1;
      visibility: visible;
      transform: translate(-50%, -50%) scale(1);
    }

    .window-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--border);
    }

    .window-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
      font-family: 'Outfit', sans-serif;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .window-close {
      width: 32px;
      height: 32px;
      border: none;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .window-close:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
    }

    .theme-grid, .layout-grid {
      display: grid;
      gap: 16px;
      padding: 16px;
      background: rgba(248, 250, 252, 0.5);
      border-radius: 16px;
      border: 1px solid rgba(226, 232, 240, 0.5);
    }

    .theme-grid {
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    }

    .layout-grid {
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    }

    .theme-card, .layout-card {
      background: white;
      border: 2px solid rgba(226, 232, 240, 0.5);
      border-radius: 12px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .theme-card:hover, .layout-card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      border-color: rgba(59, 130, 246, 0.3);
    }

    .theme-card.active, .layout-card.active {
      border-color: #3b82f6;
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(29, 78, 216, 0.05) 100%);
    }

    .theme-preview {
      width: 100%;
      height: 40px;
      border-radius: 8px;
      margin-bottom: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .theme-name, .layout-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      font-family: 'Outfit', sans-serif;
      text-align: center;
      margin-bottom: 4px;
    }

    .theme-description, .layout-description {
      font-size: 10px;
      color: var(--text-light);
      text-align: center;
      font-family: 'Inter', sans-serif;
    }

    .layout-preview {
      width: 100%;
      height: 50px;
      border: 1px solid var(--border);
      border-radius: 6px;
      position: relative;
      overflow: hidden;
      background: var(--paper);
      margin-bottom: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .layout-preview::before {
      content: '';
      position: absolute;
      background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
    }

    /* Layout preview patterns */
    .layout-card[data-layout="modern"] .layout-preview::before {
      left: 0; top: 0; bottom: 0; width: 40%;
    }
    .layout-card[data-layout="compact"] .layout-preview::before {
      left: 0; top: 0; bottom: 0; width: 30%;
    }
    .layout-card[data-layout="centered"] .layout-preview::before {
      left: 0; top: 0; right: 0; height: 30%;
    }
    .layout-card[data-layout="executive"] .layout-preview::before {
      left: 0; top: 0; bottom: 0; width: 50%;
    }
    .layout-card[data-layout="minimal"] .layout-preview::before {
      display: none;
    }
    .layout-card[data-layout="two-column"] .layout-preview::before {
      left: 48%; top: 0; bottom: 0; width: 4%;
    }
    .layout-card[data-layout="split"] .layout-preview::before {
      left: 30%; top: 0; bottom: 0; width: 40%;
    }
    .layout-card[data-layout="creative"] .layout-preview::before {
      left: 0; top: 0; bottom: 0; width: 45%; transform: skew(-10deg);
    }
    .layout-card[data-layout="timeline"] .layout-preview::before {
      left: 0; top: 0; right: 0; height: 25%;
    }
    .layout-card[data-layout="magazine"] .layout-preview::before {
      left: 0; top: 0; bottom: 0; width: 35%;
    }
    .layout-card[data-layout="grid"] .layout-preview::before {
      left: 0; top: 0; width: 30%; height: 100%; 
      background: repeating-linear-gradient(90deg, #e2e8f0, #e2e8f0 2px, transparent 2px, transparent 16px);
    }

    /* Window backdrop */
    .window-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(5px);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .window-backdrop.active {
      opacity: 1;
      visibility: visible;
    }

    .spacer { flex: 1; }

    /* =========================================================
       PAPER & CV LAYOUT
    ========================================================= */
    .paper {
      width: 280mm;
      background: var(--paper);
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      border: 1px solid var(--border);
    }

    .accent-bar {
      height: 8px;
      background: var(--gradient-primary);
      position: relative;
      overflow: hidden;
    }

    .accent-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* Force animations to work on all devices - but preserve main page transitions */
    @media (prefers-reduced-motion: reduce) {
      /* Keep essential animations */
      .accent-bar::after {
        animation: shimmer 3s infinite !important;
      }
      
      .loading-spinner {
        animation: spin 1s linear infinite !important;
      }
      
      .control-slider {
        animation: shimmer 3s ease-in-out infinite !important;
      }
      
      /* Keep layout and hover transitions */
      .cv,
      .sidebar,
      .main-content,
      .btn,
      .photo,
      .skill-pill,
      .theme-card,
      .layout-card,
      .selector-window,
      .window-backdrop {
        transition: all 0.3s ease !important;
      }
      
      .btn:hover {
        transition: all 0.3s ease !important;
        transform: translateY(-2px) !important;
      }
      
      .photo:hover {
        transition: all 0.3s ease !important;
        transform: scale(1.02) rotate(2deg) !important;
      }
    }

    /* =========================================================
       SIDEBAR
    ========================================================= */
    .sidebar {
      background: var(--sidebar-bg);
      padding: 15mm 10mm;
      border-right: 1px solid var(--border);
      position: relative;
    }

    .sidebar::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 1px;
      height: 100%;
      background: var(--gradient-primary);
      opacity: 0.3;
    }

    .photo-container {
      position: relative;
      width: 45mm;
      height: 45mm;
      margin: 0 auto 8mm;
    }

    .photo {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      border: 3px solid transparent;
      background: var(--gradient-primary);
      background-clip: border-box;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .photo:hover {
      transform: scale(1.02) rotate(2deg);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    }

    .photo-btn {
      position: absolute;
      bottom: -6px;
      right: -6px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--gradient-primary);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }

    .photo-btn:hover {
      transform: scale(1.1);
    }

    .name {
      font-size: 20px;
      font-weight: 900;
      text-align: center;
      margin: 0 0 3mm;
      color: var(--text);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-family: 'Outfit', sans-serif;
      letter-spacing: -0.5px;
    }

    .title {
      font-size: 14px;
      font-weight: 600;
      text-align: center;
      color: var(--text-light);
      margin: 0 0 8mm;
      font-family: 'Outfit', sans-serif;
    }

    .sidebar-section {
      margin: 8mm 0 0;
    }

    .sidebar-section h3 {
      font-size: 11px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 4mm;
      padding-bottom: 2mm;
      border-bottom: 2px solid;
      border-image: var(--gradient-primary) 1;
      font-family: 'Outfit', sans-serif;
    }

    .info-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .info-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 3mm;
      font-size: 12px;
      line-height: 1.4;
      position: relative;
      color: var(--text);
    }

    .info-icon {
      width: 14px;
      text-align: center;
      flex-shrink: 0;
      margin-top: 1px;
      font-size: 12px;
    }

    .skill-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .skill-pill {
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      color: var(--text);
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 10px;
      font-weight: 700;
      position: relative;
      font-family: 'Outfit', sans-serif;
      transition: all 0.3s ease;
    }

    .skill-pill:hover {
      background: var(--gradient-accent);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .language-item {
      margin-bottom: 4mm;
      position: relative;
    }

    .language-header {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 2mm;
      font-family: 'Outfit', sans-serif;
    }

    .progress-bar {
      height: 6px;
      background: var(--border);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-primary);
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    /* Remove buttons */
    .removable {
      position: relative;
    }

    .remove-btn {
      position: absolute;
      top: -4px;
      right: -4px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
      color: white;
      border: none;
      font-size: 10px;
      cursor: pointer;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
      transition: all 0.3s ease;
    }

    .remove-btn:hover {
      transform: scale(1.2);
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.6);
    }

    .editing .removable:hover .remove-btn {
      display: flex;
    }

    /* =========================================================
       MAIN CONTENT
    ========================================================= */
    .main-content {
      padding: 15mm 15mm;
      background: var(--paper);
    }

    .section {
      margin: 0 0 8mm;
      page-break-inside: avoid;
    }

    .section-title {
      font-size: 16px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 16px 0;
      padding: 8px 0;
      border-bottom: 2px solid;
      border-image: var(--gradient-primary) 1;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    /* Enhanced contrast for dark themes */
    [data-theme="cyber"] .section-title,
    [data-theme="midnight"] .section-title,
    [data-theme="executive"] .section-title,
    [data-theme="charcoal"] .section-title,
    [data-theme="steel"] .section-title,
    [data-theme="bronze"] .section-title,
    [data-theme="navy"] .section-title,
    [data-theme="carbon"] .section-title,
    [data-theme="military"] .section-title,
    [data-theme="burgundy"] .section-title {
      color: var(--text);
      -webkit-text-fill-color: var(--text);
      text-shadow: 0 0 4px rgba(255, 255, 255, 0.3);
      font-weight: 900;
    }

    /* Fallback for browsers that don't support background-clip */
    @supports not (-webkit-background-clip: text) {
      .section-title {
        color: var(--text);
        font-weight: 900;
      }
    }

    /* Enhanced text contrast and readability */
    .cv {
      color: var(--text);
      line-height: 1.6;
    }

    .name, .title, .job-title, .card-title {
      color: var(--text);
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }

    .job-meta, .card-subtitle, .card-meta {
      color: var(--text-light);
      font-weight: 500;
    }

    .job-desc, .card-desc {
      color: var(--text);
      font-weight: 400;
    }

    /* Dark theme enhancements - Much stronger contrast */
    [data-theme="cyber"] .cv,
    [data-theme="midnight"] .cv,
    [data-theme="executive"] .cv,
    [data-theme="charcoal"] .cv,
    [data-theme="steel"] .cv,
    [data-theme="bronze"] .cv,
    [data-theme="navy"] .cv,
    [data-theme="carbon"] .cv,
    [data-theme="military"] .cv,
    [data-theme="burgundy"] .cv {
      color: var(--text);
    }

    /* Enhanced titles for dark themes - NO BLUR/SHADOWS */
    [data-theme="cyber"] .name,
    [data-theme="midnight"] .name,
    [data-theme="executive"] .name,
    [data-theme="charcoal"] .name,
    [data-theme="steel"] .name,
    [data-theme="bronze"] .name,
    [data-theme="navy"] .name,
    [data-theme="carbon"] .name,
    [data-theme="military"] .name,
    [data-theme="burgundy"] .name {
      color: #ffffff !important;
      font-weight: 900;
      text-shadow: none !important;
    }

    [data-theme="cyber"] .title,
    [data-theme="midnight"] .title,
    [data-theme="executive"] .title,
    [data-theme="charcoal"] .title,
    [data-theme="steel"] .title,
    [data-theme="bronze"] .title,
    [data-theme="navy"] .title,
    [data-theme="carbon"] .title,
    [data-theme="military"] .title,
    [data-theme="burgundy"] .title {
      color: #e2e8f0 !important;
      font-weight: 600;
      text-shadow: none !important;
    }

    /* Job titles and card titles on dark themes - CRISP AND CLEAR */
    [data-theme="cyber"] .job-title,
    [data-theme="midnight"] .job-title,
    [data-theme="executive"] .job-title,
    [data-theme="charcoal"] .job-title,
    [data-theme="steel"] .job-title,
    [data-theme="bronze"] .job-title,
    [data-theme="navy"] .job-title,
    [data-theme="carbon"] .job-title,
    [data-theme="military"] .job-title,
    [data-theme="burgundy"] .job-title,
    [data-theme="cyber"] .card-title,
    [data-theme="midnight"] .card-title,
    [data-theme="executive"] .card-title,
    [data-theme="charcoal"] .card-title,
    [data-theme="steel"] .card-title,
    [data-theme="bronze"] .card-title,
    [data-theme="navy"] .card-title,
    [data-theme="carbon"] .card-title,
    [data-theme="military"] .card-title,
    [data-theme="burgundy"] .card-title {
      color: #ffffff !important;
      font-weight: 800;
      text-shadow: none !important;
    }

    /* Job meta, subtitles on dark themes - CLEAR TEXT */
    [data-theme="cyber"] .job-meta,
    [data-theme="midnight"] .job-meta,
    [data-theme="executive"] .job-meta,
    [data-theme="charcoal"] .job-meta,
    [data-theme="steel"] .job-meta,
    [data-theme="bronze"] .job-meta,
    [data-theme="navy"] .job-meta,
    [data-theme="carbon"] .job-meta,
    [data-theme="military"] .job-meta,
    [data-theme="burgundy"] .job-meta,
    [data-theme="cyber"] .card-subtitle,
    [data-theme="midnight"] .card-subtitle,
    [data-theme="executive"] .card-subtitle,
    [data-theme="charcoal"] .card-subtitle,
    [data-theme="steel"] .card-subtitle,
    [data-theme="bronze"] .card-subtitle,
    [data-theme="navy"] .card-subtitle,
    [data-theme="carbon"] .card-subtitle,
    [data-theme="military"] .card-subtitle,
    [data-theme="burgundy"] .card-subtitle,
    [data-theme="cyber"] .card-meta,
    [data-theme="midnight"] .card-meta,
    [data-theme="executive"] .card-meta,
    [data-theme="charcoal"] .card-meta,
    [data-theme="steel"] .card-meta,
    [data-theme="bronze"] .card-meta,
    [data-theme="navy"] .card-meta,
    [data-theme="carbon"] .card-meta,
    [data-theme="military"] .card-meta,
    [data-theme="burgundy"] .card-meta {
      color: #cbd5e1 !important;
      font-weight: 600;
      text-shadow: none !important;
    }

    /* Description text on dark themes - SHARP AND READABLE */
    [data-theme="cyber"] .job-desc,
    [data-theme="midnight"] .job-desc,
    [data-theme="executive"] .job-desc,
    [data-theme="charcoal"] .job-desc,
    [data-theme="steel"] .job-desc,
    [data-theme="bronze"] .job-desc,
    [data-theme="navy"] .job-desc,
    [data-theme="carbon"] .job-desc,
    [data-theme="military"] .job-desc,
    [data-theme="burgundy"] .job-desc,
    [data-theme="cyber"] .card-desc,
    [data-theme="midnight"] .card-desc,
    [data-theme="executive"] .card-desc,
    [data-theme="charcoal"] .card-desc,
    [data-theme="steel"] .card-desc,
    [data-theme="bronze"] .card-desc,
    [data-theme="navy"] .card-desc,
    [data-theme="carbon"] .card-desc,
    [data-theme="military"] .card-desc,
    [data-theme="burgundy"] .card-desc {
      color: #f1f5f9 !important;
      font-weight: 500;
      text-shadow: none !important;
    }

    /* List items and achievements - NO SHADOWS */
    [data-theme="cyber"] .job-achievements li,
    [data-theme="midnight"] .job-achievements li,
    [data-theme="executive"] .job-achievements li,
    [data-theme="charcoal"] .job-achievements li,
    [data-theme="steel"] .job-achievements li,
    [data-theme="bronze"] .job-achievements li,
    [data-theme="navy"] .job-achievements li,
    [data-theme="carbon"] .job-achievements li,
    [data-theme="military"] .job-achievements li,
    [data-theme="burgundy"] .job-achievements li,
    [data-theme="cyber"] .simple-list li,
    [data-theme="midnight"] .simple-list li,
    [data-theme="executive"] .simple-list li,
    [data-theme="charcoal"] .simple-list li,
    [data-theme="steel"] .simple-list li,
    [data-theme="bronze"] .simple-list li,
    [data-theme="navy"] .simple-list li,
    [data-theme="carbon"] .simple-list li,
    [data-theme="military"] .simple-list li,
    [data-theme="burgundy"] .simple-list li {
      color: #e2e8f0 !important;
      text-shadow: none !important;
    }

    /* Info items in sidebar - CLEAN TEXT */
    [data-theme="cyber"] .info-item,
    [data-theme="midnight"] .info-item,
    [data-theme="executive"] .info-item,
    [data-theme="charcoal"] .info-item,
    [data-theme="steel"] .info-item,
    [data-theme="bronze"] .info-item,
    [data-theme="navy"] .info-item,
    [data-theme="carbon"] .info-item,
    [data-theme="military"] .info-item,
    [data-theme="burgundy"] .info-item {
      color: #f1f5f9 !important;
      text-shadow: none !important;
    }

    /* Skill pills enhanced contrast */
    .skill-pill {
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      color: var(--text);
      font-weight: 600;
      backdrop-filter: blur(10px);
    }

    [data-theme="cyber"] .skill-pill,
    [data-theme="midnight"] .skill-pill,
    [data-theme="executive"] .skill-pill,
    [data-theme="charcoal"] .skill-pill,
    [data-theme="steel"] .skill-pill,
    [data-theme="bronze"] .skill-pill,
    [data-theme="navy"] .skill-pill,
    [data-theme="carbon"] .skill-pill,
    [data-theme="military"] .skill-pill,
    [data-theme="burgundy"] .skill-pill {
      color: #ffffff !important;
      border-color: var(--pill-border);
      font-weight: 700;
      text-shadow: none !important;
    }

    .summary {
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      padding: 6mm;
      border-radius: 12px;
      font-size: 13px;
      line-height: 1.7;
      color: var(--text);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      position: relative;
      overflow: hidden;
    }

    .summary::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--gradient-primary);
    }

    .timeline {
      position: relative;
      margin-left: 4mm;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 3mm;
      top: 0;
      bottom: 0;
      width: 2px;
      background: var(--gradient-primary);
      border-radius: 1px;
    }

    .timeline-item {
      position: relative;
      padding: 3mm 0 4mm 12mm;
      page-break-inside: avoid;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: 2mm;
      top: 4mm;
      width: 4mm;
      height: 4mm;
      background: var(--gradient-primary);
      border-radius: 50%;
      box-shadow: 0 0 0 3px var(--paper), 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .job-title {
      font-size: 15px;
      font-weight: 800;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 2mm;
      font-family: 'Outfit', sans-serif;
    }

    .job-meta {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-light);
      margin: 0 0 2mm;
      font-family: 'Outfit', sans-serif;
    }

    .job-desc {
      font-size: 12px;
      line-height: 1.6;
      color: var(--text);
      margin: 0 0 3mm;
    }

    .job-achievements {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .job-achievements li {
      font-size: 12px;
      line-height: 1.5;
      color: var(--text);
      margin-bottom: 2mm;
      padding-left: 4mm;
      position: relative;
    }

    .job-achievements li::before {
      content: '▶';
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: bold;
      position: absolute;
      left: 0;
      font-size: 10px;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6mm;
    }

    .card {
      background: linear-gradient(135deg, var(--paper) 0%, #fafbfc 100%);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 4mm;
      page-break-inside: avoid;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-primary);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    }

    .card-title {
      font-size: 13px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 2mm;
      font-family: 'Outfit', sans-serif;
    }

    .card-subtitle {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-light);
      margin: 0 0 1mm;
      font-family: 'Outfit', sans-serif;
    }

    .card-meta {
      font-size: 10px;
      font-weight: 700;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 2mm;
      font-family: 'Outfit', sans-serif;
    }

    .card-desc {
      font-size: 11px;
      line-height: 1.5;
      color: var(--text);
    }

    .simple-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .simple-list li {
      font-size: 12px;
      line-height: 1.6;
      color: var(--text);
      margin-bottom: 2mm;
      padding-left: 4mm;
      position: relative;
    }

    .simple-list li::before {
      content: '✦';
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    /* Contact inline for minimal layout */
    .contact-inline {
      display: none;
    }

    [data-layout="minimal"] .contact-inline {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 6mm 0;
      flex-wrap: wrap;
    }

    [data-layout="minimal"] .contact-inline .info-item {
      margin-bottom: 0;
    }

    /* =========================================================
       EDITING STATES
    ========================================================= */
    [data-editable] {
      outline: 2px dashed transparent;
      outline-offset: 2px;
      transition: all 0.3s ease;
      border-radius: 4px;
    }

    .editing [data-editable]:hover {
      outline-color: rgba(102, 126, 234, 0.5);
      background: rgba(102, 126, 234, 0.05);
    }

    .editing [data-editable]:focus {
      outline-color: rgba(102, 126, 234, 0.8);
      outline-style: solid;
      background: rgba(102, 126, 234, 0.08);
    }

    .hint {
      background: linear-gradient(135deg, var(--pill-bg), rgba(102, 126, 234, 0.05));
      border: 1px solid var(--pill-border);
      border-left: 4px solid var(--gradient-primary);
      padding: 3mm;
      margin-top: 4mm;
      border-radius: 8px;
      font-size: 11px;
      color: var(--text-light);
      font-family: 'Outfit', sans-serif;
    }

    /* =========================================================
       PRINT STYLES
    ========================================================= */
    @media print {
      @page {
        size: A4;
        margin: 15mm;
        /* Remove browser default headers/footers */
        @top-left { content: ""; }
        @top-center { content: ""; }
        @top-right { content: ""; }
        @bottom-left { content: ""; }
        @bottom-center { content: ""; }
        @bottom-right { content: ""; }
      }

      body {
        background: white !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        font-size: 11pt !important;
        line-height: 1.4 !important;
      }

      /* Hide unwanted elements */
      #controls,
      .hint,
      .remove-btn,
      .btn,
      .photo-modal,
      header,
      footer,
      .no-print {
        display: none !important;
      }

      #app {
        max-width: none;
        margin: 0;
        padding: 0;
      }

      .paper {
        box-shadow: none;
        border: none;
        border-radius: 0;
        width: auto;
        margin: 0;
        padding: 0;
      }

      .cv {
        margin: 0 !important;
        padding: 0 !important;
        font-size: 10pt !important;
        line-height: 1.4 !important;
      }

      .accent-bar::after {
        display: none;
      }

      /* Better spacing for A4 page */
      .section {
        margin-bottom: 6mm !important;
        padding: 0 !important;
        page-break-inside: auto !important; /* Allow sections to break naturally */
      }

      .section-title {
        font-size: 12pt !important;
        margin-bottom: 3mm !important;
        padding: 2mm 0 !important;
        page-break-after: avoid !important; /* Keep title with following content */
      }

      .timeline-item {
        page-break-inside: auto !important; /* Allow items to break if needed */
        margin-bottom: 4mm !important;
        padding: 0 !important;
        orphans: 2 !important; /* Minimum 2 lines at bottom of page */
        widows: 2 !important; /* Minimum 2 lines at top of page */
      }

      .card {
        page-break-inside: auto !important; /* Allow cards to break if needed */
        margin-bottom: 3mm !important;
        padding: 3mm !important;
        orphans: 2 !important;
        widows: 2 !important;
      }

      .photo-container {
        width: 35mm !important;
        height: 35mm !important;
      }

      .photo {
        width: 35mm !important;
        height: 35mm !important;
      }

      /* Compact sidebar */
      /* Layout-specific content padding */
      
      /* Two-column layouts padding - better spacing for A4 */
      [data-layout="default"] .sidebar,
      [data-layout="professional"] .sidebar,
      [data-layout="modern"] .sidebar,
      [data-layout="compact"] .sidebar,
      [data-layout="executive"] .sidebar,
      [data-layout="creative"] .sidebar,
      [data-layout="split"] .sidebar,
      [data-layout="elegant"] .sidebar {
        padding: 6mm 10mm 0 6mm !important;
        margin: 0 !important;
      }

      [data-layout="default"] .main-content,
      [data-layout="professional"] .main-content,
      [data-layout="modern"] .main-content,
      [data-layout="compact"] .main-content,
      [data-layout="executive"] .main-content,
      [data-layout="creative"] .main-content,
      [data-layout="split"] .main-content,
      [data-layout="elegant"] .main-content {
        padding: 6mm 6mm 0 14mm !important;
        margin: 0 !important;
      }

      /* Single-column layouts padding - better spacing */
      [data-layout="timeline"] .main-content,
      [data-layout="clean"] .main-content,
      [data-layout="academic"] .main-content {
        padding: 6mm !important;
        margin: 0 !important;
      }

      /* Better sized text for A4 readability */
      .name {
        font-size: 18pt !important;
        margin: 0 0 2mm 0 !important;
      }

      .title {
        font-size: 12pt !important;
        margin: 0 0 4mm 0 !important;
      }

      .job-title, .card-title {
        font-size: 11pt !important;
        margin: 0 0 2mm 0 !important;
      }

      .job-meta, .card-subtitle, .card-meta {
        font-size: 9pt !important;
        margin: 0 0 2mm 0 !important;
      }

      .job-desc, .card-desc {
        font-size: 10pt !important;
        margin: 0 0 3mm 0 !important;
      }

      /* Timeline and Experience formatting for print - flexible pagination */
      .timeline-item {
        margin-bottom: 4mm !important;
        page-break-inside: auto !important; /* Allow natural breaking */
        orphans: 2 !important;
        widows: 2 !important;
      }

      /* Keep timeline lines but move them much further left */
      .timeline::before {
        left: -8mm !important;
        width: 1px !important;
      }

      .timeline-item::before {
        left: -8.5mm !important;
        width: 3mm !important;
        height: 3mm !important;
      }

      /* Hide camera button in print */
      .photo-btn {
        display: none !important;
      }

      .job-achievements, .simple-list {
        margin: 1mm 0 !important;
        padding-left: 8mm !important;
      }

      .job-achievements li, .simple-list li {
        margin: 0 0 1mm 0 !important;
        font-size: 8pt !important;
        padding-left: 0 !important;
        text-indent: -3mm !important;
        margin-left: 3mm !important;
      }

      .skill-pill {
        font-size: 7pt !important;
        padding: 1mm 2mm !important;
        margin: 0 1mm 1mm 0 !important;
      }

      .info-item {
        font-size: 8pt !important;
        margin: 0 0 1mm 0 !important;
      }

      /* Layout-specific print styles */
      
      /* Two-column layouts (default, professional, modern) */
      [data-layout="default"] .cv,
      [data-layout="professional"] .cv,
      [data-layout="modern"] .cv {
        display: grid !important;
        grid-template-columns: 60mm 1fr !important;
        gap: 8mm !important;
      }

      /* Timeline layout - keep original structure */
      [data-layout="timeline"] .cv {
        display: block !important;
        grid-template-columns: none !important;
      }

      [data-layout="timeline"] .main-content {
        padding: 4mm !important;
      }

      /* Clean layout - single column */
      [data-layout="clean"] .cv {
        display: block !important;
        grid-template-columns: none !important;
      }

      [data-layout="clean"] .main-content {
        padding: 4mm !important;
      }

      /* Compact layout - tighter grid */
      [data-layout="compact"] .cv {
        display: grid !important;
        grid-template-columns: 55mm 1fr !important;
        gap: 6mm !important;
      }

      /* Executive layout - wider sidebar */
      [data-layout="executive"] .cv {
        display: grid !important;
        grid-template-columns: 70mm 1fr !important;
        gap: 10mm !important;
      }

      /* Creative layout - flexible grid */
      [data-layout="creative"] .cv {
        display: grid !important;
        grid-template-columns: 65mm 1fr !important;
        gap: 8mm !important;
      }

      /* Split layout - equal columns */
      [data-layout="split"] .cv {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        gap: 8mm !important;
      }

      /* Elegant layout - refined grid */
      [data-layout="elegant"] .cv {
        display: grid !important;
        grid-template-columns: 62mm 1fr !important;
        gap: 9mm !important;
      }

      /* Academic layout - traditional structure */
      [data-layout="academic"] .cv {
        display: block !important;
        grid-template-columns: none !important;
      }

      [data-layout="academic"] .main-content {
        padding: 4mm !important;
      }

      /* Minimal layout adjustments */
      [data-layout="minimal"] .cv {
        display: block !important;
        grid-template-columns: none !important;
      }

      [data-layout="minimal"] .main-content {
        padding: 4mm !important;
      }

      [data-layout="minimal"] .minimal-header {
        margin-bottom: 6mm !important;
        padding: 0 !important;
        padding-bottom: 3mm !important;
      }
    }

    /* =========================================================
       DESKTOP ONLY - ALL SCREEN SIZES USE SAME LAYOUT
    ========================================================= */
    /* Removed mobile responsive breakpoints to maintain desktop layout on all devices */

/* Fix for invisible text while editing cards */
.editing .card [data-editable]:focus,
.editing .card [data-editable]:hover {
  -webkit-text-fill-color: var(--text) !important;
  background: rgba(102, 126, 234, 0.08) !important;
  color: var(--text) !important;
}

.editing .card-title:focus,
.editing .card-subtitle:focus,
.editing .card-meta:focus {
  -webkit-text-fill-color: var(--text) !important;
  background: rgba(102, 126, 234, 0.08) !important;
  color: var(--text) !important;
}

/* Ensure text is visible during editing */
.editing [data-editable]:focus {
  -webkit-text-fill-color: var(--text) !important;
  color: var(--text) !important;
  background: rgba(102, 126, 234, 0.08) !important;
}
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">Initializing CV Builder</div>
      <div class="loading-subtext">Preparing your professional template...</div>
    </div>
  </div>

  <div id="app">
    <!-- Enhanced Controls -->
    <div id="controls">
      <button id="toggleEdit" class="btn">🔓 Edit Mode</button>
      <button id="addJob" class="btn">➕ Job</button>
      <button id="addEducation" class="btn">🎓 Education</button>
      
      <div class="selector-group">
        <div class="selector-label" onclick="openWindow('theme')" data-tooltip="Themes">🎨</div>
      </div>
      
      <div class="selector-group">
        <div class="selector-label" onclick="openWindow('layout')" data-tooltip="Layouts">📐</div>
      </div>
      
      <div class="spacer"></div>
      
      <button id="reset" class="btn danger">🗑️ Reset</button>
      <button id="export" class="btn primary">📄 Export PDF</button>
    </div>

    <!-- Window Backdrop -->
    <div class="window-backdrop" id="windowBackdrop"></div>

    <!-- Theme Selection Window -->
    <div class="selector-window" id="themeWindow">
      <div class="window-header">
        <h3 class="window-title">🎨 Choose Your Theme</h3>
        <button class="window-close" onclick="closeWindow()">×</button>
      </div>
      <div class="theme-grid">
        <div class="theme-card active" data-theme="monochrome">
          <div class="theme-preview" style="background: linear-gradient(135deg, #434343 0%, #000000 100%);"></div>
          <div class="theme-name">Black & White</div>
          <div class="theme-description">Classic professional</div>
        </div>
        <div class="theme-card" data-theme="ocean">
          <div class="theme-preview" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
          <div class="theme-name">Ocean</div>
          <div class="theme-description">Deep blue professional</div>
        </div>
        <div class="theme-card" data-theme="sunset">
          <div class="theme-preview" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"></div>
          <div class="theme-name">Sunset</div>
          <div class="theme-description">Warm and energetic</div>
        </div>
        <div class="theme-card" data-theme="forest">
          <div class="theme-preview" style="background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);"></div>
          <div class="theme-name">Forest</div>
          <div class="theme-description">Natural and calm</div>
        </div>
        <div class="theme-card" data-theme="royal">
          <div class="theme-preview" style="background: linear-gradient(135deg, #667eea 0%, #f093fb 100%);"></div>
          <div class="theme-name">Royal</div>
          <div class="theme-description">Elegant purple tones</div>
        </div>
        <div class="theme-card" data-theme="aurora">
          <div class="theme-preview" style="background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);"></div>
          <div class="theme-name">Aurora</div>
          <div class="theme-description">Dreamy pastels</div>
        </div>
        <div class="theme-card" data-theme="cyber">
          <div class="theme-preview" style="background: linear-gradient(135deg, #0f0c29 0%, #24243e 100%);"></div>
          <div class="theme-name">Cyber</div>
          <div class="theme-description">Futuristic dark</div>
        </div>
        <div class="theme-card" data-theme="midnight">
          <div class="theme-preview" style="background: linear-gradient(135deg, #232526 0%, #414345 100%);"></div>
          <div class="theme-name">Midnight</div>
          <div class="theme-description">Sophisticated dark</div>
        </div>
        <div class="theme-card" data-theme="coral">
          <div class="theme-preview" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);"></div>
          <div class="theme-name">Coral</div>
          <div class="theme-description">Soft and friendly</div>
        </div>
        <div class="theme-card" data-theme="emerald">
          <div class="theme-preview" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);"></div>
          <div class="theme-name">Emerald</div>
          <div class="theme-description">Fresh green energy</div>
        </div>
        <div class="theme-card" data-theme="golden">
          <div class="theme-preview" style="background: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);"></div>
          <div class="theme-name">Golden</div>
          <div class="theme-description">Luxurious warmth</div>
        </div>
        <div class="theme-card" data-theme="lavender">
          <div class="theme-preview" style="background: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%);"></div>
          <div class="theme-name">Lavender</div>
          <div class="theme-description">Gentle and soothing</div>
        </div>
        <div class="theme-card" data-theme="neon">
          <div class="theme-preview" style="background: linear-gradient(135deg, #ff006e 0%, #8338ec 100%);"></div>
          <div class="theme-name">Neon</div>
          <div class="theme-description">Vibrant and bold</div>
        </div>
        <div class="theme-card" data-theme="executive">
          <div class="theme-preview" style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%);"></div>
          <div class="theme-name">Executive Dark</div>
          <div class="theme-description">Professional dark mode</div>
        </div>
        <div class="theme-card" data-theme="charcoal">
          <div class="theme-preview" style="background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);"></div>
          <div class="theme-name">Charcoal Pro</div>
          <div class="theme-description">Sophisticated charcoal</div>
        </div>
        <div class="theme-card" data-theme="steel">
          <div class="theme-preview" style="background: linear-gradient(135deg, #334155 0%, #475569 100%);"></div>
          <div class="theme-name">Steel Blue</div>
          <div class="theme-description">Industrial strength</div>
        </div>
        <div class="theme-card" data-theme="bronze">
          <div class="theme-preview" style="background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);"></div>
          <div class="theme-name">Masculine Bronze</div>
          <div class="theme-description">Rich bronze tones</div>
        </div>
        <div class="theme-card" data-theme="navy">
          <div class="theme-preview" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);"></div>
          <div class="theme-name">Deep Navy</div>
          <div class="theme-description">Naval authority</div>
        </div>
        <div class="theme-card" data-theme="carbon">
          <div class="theme-preview" style="background: linear-gradient(135deg, #18181b 0%, #27272a 100%);"></div>
          <div class="theme-name">Carbon Black</div>
          <div class="theme-description">Premium carbon fiber</div>
        </div>
        <div class="theme-card" data-theme="military">
          <div class="theme-preview" style="background: linear-gradient(135deg, #365314 0%, #4d7c0f 100%);"></div>
          <div class="theme-name">Military Green</div>
          <div class="theme-description">Tactical precision</div>
        </div>
        <div class="theme-card" data-theme="burgundy">
          <div class="theme-preview" style="background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 100%);"></div>
          <div class="theme-name">Burgundy Pro</div>
          <div class="theme-description">Executive burgundy</div>
        </div>
      </div>
    </div>

    <!-- Layout Selection Window -->
    <div class="selector-window" id="layoutWindow">
      <div class="window-header">
        <h3 class="window-title">📐 Choose Your Layout</h3>
        <button class="window-close" onclick="closeWindow()">×</button>
      </div>
      <div class="layout-grid">
        <div class="layout-card active" data-layout="modern">
          <div class="layout-preview"></div>
          <div class="layout-name">Modern</div>
          <div class="layout-description">Professional sidebar layout</div>
        </div>
        <div class="layout-card" data-layout="compact">
          <div class="layout-preview"></div>
          <div class="layout-name">Compact</div>
          <div class="layout-description">Space-efficient design</div>
        </div>
        <div class="layout-card" data-layout="centered">
          <div class="layout-preview"></div>
          <div class="layout-name">Centered</div>
          <div class="layout-description">Balanced center focus</div>
        </div>
        <div class="layout-card" data-layout="executive">
          <div class="layout-preview"></div>
          <div class="layout-name">Executive</div>
          <div class="layout-description">Premium wide sidebar</div>
        </div>
        <div class="layout-card" data-layout="minimal">
          <div class="layout-preview"></div>
          <div class="layout-name">Minimal</div>
          <div class="layout-description">Clean single column</div>
        </div>
        <div class="layout-card" data-layout="two-column">
          <div class="layout-preview"></div>
          <div class="layout-name">Two Column</div>
          <div class="layout-description">Equal split design</div>
        </div>
        <div class="layout-card" data-layout="split">
          <div class="layout-preview"></div>
          <div class="layout-name">Split</div>
          <div class="layout-description">Center divider style</div>
        </div>
        <div class="layout-card" data-layout="creative">
          <div class="layout-preview"></div>
          <div class="layout-name">Creative</div>
          <div class="layout-description">Artistic angled design</div>
        </div>
        <div class="layout-card" data-layout="timeline">
          <div class="layout-preview"></div>
          <div class="layout-name">Timeline</div>
          <div class="layout-description">Chronological flow</div>
        </div>
        <div class="layout-card" data-layout="magazine">
          <div class="layout-preview"></div>
          <div class="layout-name">Magazine</div>
          <div class="layout-description">Editorial style layout</div>
        </div>
        <div class="layout-card" data-layout="grid">
          <div class="layout-preview"></div>
          <div class="layout-name">Grid</div>
          <div class="layout-description">Modern grid system</div>
        </div>
      </div>
    </div>
    <div class="photo-modal" id="photoModal">
      <div class="crop-container">
        <div class="editor-shell">
          <div class="editor-canvas-panel">
            <div class="editor-header">
              <h3 class="editor-title">Photo Editor - Direct Edit Mode</h3>
              <button class="editor-close" id="closeCrop" aria-label="Close">×</button>
            </div>
            <div class="canvas-wrapper">
              <div class="canvas-area unified-editor" id="cropArea">
                <img class="canvas-image live-preview" id="cropImage" />
                <div class="shape-overlay" id="shapeOverlay"></div>
              </div>
              <div class="quick-bar">
                <div class="quick-item">
                  <label>Zoom <span id="zoomValue">100%</span></label>
                  <input type="range" id="zoomSlider" min="10" max="1000" value="100">
                </div>
                <div class="quick-item">
                  <label>Brightness <span id="brightnessValue">100%</span></label>
                  <input type="range" id="brightnessSlider" min="50" max="200" value="100">
                </div>
                <div class="quick-item rotate">
                  <label>Rotate <span id="rotationValue">0°</span></label>
                  <div class="rotate-row">
                    <button id="rotateLeft" class="mini-btn" title="Rotate Left">↺</button>
                    <input type="range" id="rotationSlider" min="-180" max="180" value="0">
                    <button id="rotateRight" class="mini-btn" title="Rotate Right">↻</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="actions-bar">
              <button class="action-btn" id="resetCrop">Reset</button>
              <button class="action-btn" id="cancelCrop">Cancel</button>
              <button class="action-btn primary" id="applyCrop">Apply</button>
            </div>
          </div>
          <aside class="editor-sidebar">
            <div class="sidebar-scroll">
              <section class="side-section shape-section">
                <h4 class="sec-heading">Shape</h4>
                <div class="shapes-row">
                  <button class="shape-btn active" data-shape="square" title="Square">□</button>
                  <button class="shape-btn" data-shape="circle" title="Circle">●</button>
                  <button class="shape-btn" data-shape="rounded" title="Rounded">▢</button>
                  <button class="shape-btn" data-shape="hexagon" title="Hexagon">⬡</button>
                </div>
              </section>
              <section class="side-section" data-group="transform">
                <button class="collapse-toggle" type="button">Transform</button>
                <div class="section-body">
                  <label class="slider-label">Width <span id="widthValue">100%</span>
                    <input type="range" id="widthSlider" min="50" max="300" value="100">
                  </label>
                  <label class="slider-label">Height <span id="heightValue">100%</span>
                    <input type="range" id="heightSlider" min="50" max="300" value="100">
                  </label>
                  <label class="checkbox-label"><input type="checkbox" id="lockAspectRatio" checked> Lock Aspect Ratio</label>
                </div>
              </section>
              <section class="side-section" data-group="adjustments">
                <button class="collapse-toggle" type="button">Adjustments</button>
                <div class="section-body">
                  <label class="slider-label">Contrast <span id="contrastValue">100%</span>
                    <input type="range" id="contrastSlider" min="50" max="200" value="100">
                  </label>
                  <label class="slider-label">Saturation <span id="saturationValue">100%</span>
                    <input type="range" id="saturationSlider" min="0" max="200" value="100">
                  </label>
                  <label class="slider-label">Vibrance <span id="vibranceValue">0%</span>
                    <input type="range" id="vibranceSlider" min="-100" max="100" value="0">
                  </label>
                </div>
              </section>
              <section class="side-section" data-group="details">
                <button class="collapse-toggle" type="button">Details</button>
                <div class="section-body">
                  <label class="slider-label">Sharpness <span id="sharpnessValue">0%</span>
                    <input type="range" id="sharpnessSlider" min="-100" max="100" value="0">
                  </label>
                  <label class="slider-label">Vignette <span id="vignetteValue">0%</span>
                    <input type="range" id="vignetteSlider" min="0" max="100" value="0">
                  </label>
                </div>
              </section>
              <section class="side-section" data-group="filters">
                <button class="collapse-toggle" type="button">AI Filters</button>
                <div class="section-body filters-grid">
                  <button class="filter-chip active" data-preset="original">Original</button>
                  <button class="filter-chip" data-preset="vintage">Vintage</button>
                  <button class="filter-chip" data-preset="cinematic">Cinematic</button>
                  <button class="filter-chip" data-preset="warm">Warm</button>
                  <button class="filter-chip" data-preset="cool">Cool</button>
                  <button class="filter-chip" data-preset="dramatic">Dramatic</button>
                  <button class="filter-chip" data-preset="professional">Professional</button>
                  <button class="filter-chip" data-preset="artistic">Artistic</button>
                </div>
              </section>
            </div>
          </aside>
        </div>
      </div>
    </div>

    <!-- CV Paper -->
    <div class="paper">
      <div class="accent-bar"></div>
      <div class="cv editing" id="cv">
        <!-- Sidebar -->
        <div class="sidebar">
          <div class="photo-container">
            <img class="photo" id="photo" alt="Professional Photo" onclick="editPhoto()" style="cursor: pointer;" />
            <button class="photo-btn" id="photoBtn">📷</button>
            <input type="file" id="photoInput" accept="image/*" style="display: none;" />
          </div>

          <h1 class="name" data-editable contenteditable="true">Sarah Johnson, RN</h1>
          <div class="title" data-editable contenteditable="true">Emergency Registered Nurse</div>

          <!-- Contact -->
          <div class="sidebar-section">
            <h3>Contact</h3>
            <ul class="info-list" id="contactList">
              <li class="info-item removable">
                <span class="info-icon">📞</span>
                <span data-editable contenteditable="true">+971 50 123 4567</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">✉️</span>
                <span data-editable contenteditable="true">sarah.johnson@email.com</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">📍</span>
                <span data-editable contenteditable="true">Dubai, UAE</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">🔗</span>
                <span data-editable contenteditable="true">linkedin.com/in/sarah-johnson</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
            </ul>
            <button class="btn small" onclick="addContact()">+ Contact</button>
          </div>

          <!-- Skills -->
          <div class="sidebar-section">
            <h3>Skills</h3>
            <div class="skill-pills" id="skillsList">
              <span class="skill-pill removable">
                <span data-editable contenteditable="true">Emergency Triage</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </span>
              <span class="skill-pill removable">
                <span data-editable contenteditable="true">ACLS/BLS</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </span>
              <span class="skill-pill removable">
                <span data-editable contenteditable="true">IV Therapy</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </span>
              <span class="skill-pill removable">
                <span data-editable contenteditable="true">Patient Care</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </span>
              <span class="skill-pill removable">
                <span data-editable contenteditable="true">EMR Systems</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </span>
            </div>
            <button class="btn small" onclick="addSkill()" style="margin-top: 3mm;">+ Skill</button>
          </div>

          <!-- Certifications -->
          <div class="sidebar-section">
            <h3>Certifications</h3>
            <ul class="info-list" id="certsList">
              <li class="info-item removable">
                <span class="info-icon">🏆</span>
                <span data-editable contenteditable="true">BLS, ACLS, PALS</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">📋</span>
                <span data-editable contenteditable="true">DHA License</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">🩺</span>
                <span data-editable contenteditable="true">TNCC Certified</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
            </ul>
            <button class="btn small" onclick="addCertification()">+ Certification</button>
          </div>

          <!-- Languages -->
          <div class="sidebar-section">
            <h3>Languages</h3>
            <div id="languagesList">
              <div class="language-item removable">
                <div class="language-header">
                  <span data-editable contenteditable="true">English</span>
                  <span data-editable contenteditable="true">Fluent</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 95%;"></div>
                </div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>
              <div class="language-item removable">
                <div class="language-header">
                  <span data-editable contenteditable="true">Arabic</span>
                  <span data-editable contenteditable="true">Basic</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 60%;"></div>
                </div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>
            </div>
            <button class="btn small" onclick="addLanguage()">+ Language</button>
          </div>

          <!-- Personal Information -->
          <div class="sidebar-section">
            <h3>Personal</h3>
            <ul class="info-list" id="personalList">
              <li class="info-item removable">
                <span class="info-icon">💍</span>
                <span data-editable contenteditable="true">Single</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">🎂</span>
                <span data-editable contenteditable="true">Age: 28</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">🏠</span>
                <span data-editable contenteditable="true">UAE Resident</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="info-item removable">
                <span class="info-icon">🆔</span>
                <span data-editable contenteditable="true">User: imohmia</span>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
            </ul>
            <button class="btn small" onclick="addPersonalInfo()">+ Personal Info</button>
          </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
          <!-- Header for minimal layout -->
          <div class="minimal-header" style="display: none;">
            <h1 class="name" data-editable contenteditable="true">Sarah Johnson, RN</h1>
            <div class="title" data-editable contenteditable="true">Emergency Registered Nurse</div>
          </div>
          
          <!-- Contact for minimal layout -->
          <div class="contact-inline" id="contactInline">
            <div class="info-item">
              <span class="info-icon">📞</span>
              <span data-editable contenteditable="true">+971 50 123 4567</span>
            </div>
            <div class="info-item">
              <span class="info-icon">✉️</span>
              <span data-editable contenteditable="true">sarah.johnson@email.com</span>
            </div>
            <div class="info-item">
              <span class="info-icon">📍</span>
              <span data-editable contenteditable="true">Dubai, UAE</span>
            </div>
          </div>

          <!-- Professional Summary -->
          <div class="section">
            <h2 class="section-title">Professional Summary</h2>
            <div class="summary" data-editable contenteditable="true">
              Dedicated Emergency Registered Nurse with 5+ years of experience in high-acuity emergency departments. Proven expertise in patient triage, emergency protocols, and critical care management. Strong advocate for patient safety and quality improvement initiatives.
            </div>
            <div class="hint">💡 Click any text to edit. Choose themes and layouts above. Export creates a professional PDF with the same layout you see here.</div>
          </div>

          <!-- Experience -->
          <div class="section">
            <h2 class="section-title">Experience</h2>
            <div class="timeline" id="experienceList">
              <div class="timeline-item removable">
                <h3 class="job-title" data-editable contenteditable="true">Emergency Registered Nurse</h3>
                <div class="job-meta" data-editable contenteditable="true">Dubai Hospital • Dubai, UAE • 2022 – Present</div>
                <div class="job-desc" data-editable contenteditable="true">
                  Provide comprehensive emergency nursing care in 120-bed emergency department. Manage patient triage, medication administration, and family communication.
                </div>
                <ul class="job-achievements">
                  <li class="removable" data-editable contenteditable="true">Perform ESI triage assessment for 100+ patients daily
                    <button class="remove-btn" onclick="removeItem(this)">×</button>
                  </li>
                  <li class="removable" data-editable contenteditable="true">Administer emergency medications and IV therapy
                    <button class="remove-btn" onclick="removeItem(this)">×</button>
                  </li>
                  <li class="removable" data-editable contenteditable="true">Coordinate care with multidisciplinary teams
                    <button class="remove-btn" onclick="removeItem(this)">×</button>
                  </li>
                </ul>
                <button class="btn small" onclick="addAchievement(this)" style="margin-top: 2mm;">+ Achievement</button>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>

              <div class="timeline-item removable">
                <h3 class="job-title" data-editable contenteditable="true">Staff Nurse – ICU</h3>
                <div class="job-meta" data-editable contenteditable="true">City Medical Center • Dubai, UAE • 2019 – 2022</div>
                <div class="job-desc" data-editable contenteditable="true">
                  Provided critical care nursing for ventilated and post-surgical patients in 24-bed intensive care unit.
                </div>
                <ul class="job-achievements">
                  <li class="removable" data-editable contenteditable="true">Managed ventilator settings and hemodynamic monitoring
                    <button class="remove-btn" onclick="removeItem(this)">×</button>
                  </li>
                  <li class="removable" data-editable contenteditable="true">Administered vasoactive medications with precision
                    <button class="remove-btn" onclick="removeItem(this)">×</button>
                  </li>
                </ul>
                <button class="btn small" onclick="addAchievement(this)" style="margin-top: 2mm;">+ Achievement</button>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>
            </div>
          </div>

          <!-- Education -->
          <div class="section">
            <h2 class="section-title">Education</h2>
            <div class="grid-2" id="educationList">
              <div class="card removable">
                <h3 class="card-title" data-editable contenteditable="true">Bachelor of Science in Nursing</h3>
                <div class="card-subtitle" data-editable contenteditable="true">University of Dubai</div>
                <div class="card-meta" data-editable contenteditable="true">2015 – 2019</div>
                <div class="card-desc" data-editable contenteditable="true">Graduated with honors. Clinical rotations in ER, ICU, and Medical-Surgical units.</div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>

              <div class="card removable">
                <h3 class="card-title" data-editable contenteditable="true">Advanced Cardiac Life Support</h3>
                <div class="card-subtitle" data-editable contenteditable="true">American Heart Association</div>
                <div class="card-meta" data-editable contenteditable="true">2023 – Present</div>
                <div class="card-desc" data-editable contenteditable="true">Current certification in advanced cardiac life support protocols.</div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>
            </div>
          </div>

          <!-- Achievements -->
          <div class="section">
            <h2 class="section-title">Key Achievements</h2>
            <ul class="simple-list" id="achievementsList">
              <li class="removable" data-editable contenteditable="true">Employee of the Quarter – Emergency Department (2024)
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="removable" data-editable contenteditable="true">Reduced patient wait times by 20% through process improvements
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="removable" data-editable contenteditable="true">Mentored 8+ new graduate nurses successfully
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
            </ul>
            <button class="btn small" onclick="addSimpleAchievement()">+ Achievement</button>
          </div>

          <!-- Professional Responsibilities -->
          <div class="section">
            <h2 class="section-title">Professional Responsibilities</h2>
            <ul class="simple-list" id="responsibilitiesList">
              <li class="removable" data-editable contenteditable="true">Lead emergency response protocols and coordinate with medical teams
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="removable" data-editable contenteditable="true">Supervise and mentor junior nursing staff in clinical procedures
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="removable" data-editable contenteditable="true">Implement quality assurance measures and patient safety protocols
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
              <li class="removable" data-editable contenteditable="true">Maintain accurate medical records and documentation
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </li>
            </ul>
            <button class="btn small" onclick="addResponsibility()">+ Responsibility</button>
          </div>

          <!-- Professional References -->
          <div class="section">
            <h2 class="section-title">Professional References</h2>
            <div class="grid-2" id="referencesList">
              <div class="card removable">
                <h3 class="card-title" data-editable contenteditable="true">Dr. Ahmed Hassan, MD</h3>
                <div class="card-subtitle" data-editable contenteditable="true">Emergency Department Director</div>
                <div class="card-meta" data-editable contenteditable="true">Dubai Hospital</div>
                <div class="card-desc" data-editable contenteditable="true">
                  Phone: <span data-editable contenteditable="true">+971 4 XXX XXXX</span><br>
                  Email: <span data-editable contenteditable="true">a.hassan@dubaihospital.ae</span><br>
                  Relationship: Direct Supervisor (3 years)
                </div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>

              <div class="card removable">
                <h3 class="card-title" data-editable contenteditable="true">Sarah Al-Mansouri, RN, MSN</h3>
                <div class="card-subtitle" data-editable contenteditable="true">Senior Nursing Manager</div>
                <div class="card-meta" data-editable contenteditable="true">City Medical Center</div>
                <div class="card-desc" data-editable contenteditable="true">
                  Phone: <span data-editable contenteditable="true">+971 4 XXX XXXX</span><br>
                  Email: <span data-editable contenteditable="true">s.almansouri@citymed.ae</span><br>
                  Relationship: Former Manager (4 years)
                </div>
                <button class="remove-btn" onclick="removeItem(this)">×</button>
              </div>
            </div>
            <button class="btn small" onclick="addReference()">+ Reference</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Templates -->
  <template id="jobTemplate">
    <div class="timeline-item removable">
      <h3 class="job-title" data-editable contenteditable="true">Job Title</h3>
      <div class="job-meta" data-editable contenteditable="true">Company • Location • Year – Year</div>
      <div class="job-desc" data-editable contenteditable="true">Brief description of your role and responsibilities.</div>
      <ul class="job-achievements">
        <li class="removable" data-editable contenteditable="true">Key achievement or responsibility
          <button class="remove-btn" onclick="removeItem(this)">×</button>
        </li>
      </ul>
      <button class="btn small" onclick="addAchievement(this)" style="margin-top: 2mm;">+ Achievement</button>
      <button class="remove-btn" onclick="removeItem(this)">×</button>
    </div>
  </template>

   <template id="educationTemplate">
    <div class="card removable">
      <h3 class="card-title" data-editable contenteditable="true">Degree Title</h3>
      <div class="card-subtitle" data-editable contenteditable="true">Institution Name</div>
      <div class="card-meta" data-editable contenteditable="true">Year – Year</div>
      <div class="card-desc" data-editable contenteditable="true">Brief description or relevant details.</div>
      <button class="remove-btn" onclick="removeItem(this)">×</button>
    </div>
  </template>

  <script>
    // Global variables
    let isEditing = true;
    let editing = true;
    let isDragging = false;
    let currentScale = 1;
    let currentX = 0;
    let currentY = 0;
    let currentRotation = 0;
    let currentBrightness = 100;
    let currentContrast = 100;
    let currentShape = 'square';
    let currentWidthScale = 100;
    let currentHeightScale = 100;
    let lockAspectRatio = true;
    let currentSaturation = 100;
    let currentVibrance = 0;
    let currentSharpness = 0;
    let currentVignette = 0;
    let currentPreset = 'original';
    let originalImage = null;
    let cropCanvas = null;
    let cropCtx = null;

    // DOM elements
    const cv = document.getElementById('cv');
    const htmlElement = document.documentElement;
    const toggleBtn = document.getElementById('toggleEdit');
    const exportBtn = document.getElementById('export');
    const resetBtn = document.getElementById('reset');
    const addJobBtn = document.getElementById('addJob');
    const addEducationBtn = document.getElementById('addEducation');
    const photo = document.getElementById('photo');
    const photoBtn = document.getElementById('photoBtn');
    const photoInput = document.getElementById('photoInput');

    // Photo cropper elements - unified approach
    const photoModal = document.getElementById('photoModal');
    const cropImage = document.getElementById('cropImage');
    const cropArea = document.getElementById('cropArea');
    const shapeOverlay = document.getElementById('shapeOverlay');
    const zoomSlider = document.getElementById('zoomSlider');
    const rotationSlider = document.getElementById('rotationSlider');
    const brightnessSlider = document.getElementById('brightnessSlider');
    const contrastSlider = document.getElementById('contrastSlider');
    const widthSlider = document.getElementById('widthSlider');
    const heightSlider = document.getElementById('heightSlider');
    const lockAspectRatioCheckbox = document.getElementById('lockAspectRatio');
    const saturationSlider = document.getElementById('saturationSlider');
    const vibranceSlider = document.getElementById('vibranceSlider');
    const sharpnessSlider = document.getElementById('sharpnessSlider');
    const vignetteSlider = document.getElementById('vignetteSlider');
  // Updated to new filter chip buttons
  const presetButtons = document.querySelectorAll('.filter-chip');
    const closeCrop = document.getElementById('closeCrop');
    const cancelCrop = document.getElementById('cancelCrop');
    const applyCrop = document.getElementById('applyCrop');
    const resetCrop = document.getElementById('resetCrop');
    const rotateLeft = document.getElementById('rotateLeft');
    const rotateRight = document.getElementById('rotateRight');
  // Updated to new shape buttons
  const shapeOptions = document.querySelectorAll('.shape-btn');

    // Value display elements
    const zoomValue = document.getElementById('zoomValue');
    const rotationValue = document.getElementById('rotationValue');
    const brightnessValue = document.getElementById('brightnessValue');
    const contrastValue = document.getElementById('contrastValue');
    const widthValue = document.getElementById('widthValue');
    const heightValue = document.getElementById('heightValue');
    const saturationValue = document.getElementById('saturationValue');
    const vibranceValue = document.getElementById('vibranceValue');
    const sharpnessValue = document.getElementById('sharpnessValue');
    const vignetteValue = document.getElementById('vignetteValue');

    // Utility functions
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Modified save/load functions to NOT persist data
    function saveData() {
      // Intentionally empty - no saving to localStorage
      console.log('Data save disabled - fresh start on every refresh');
    }

    function loadData() {
      // Only load themes, no content data
      const savedTheme = localStorage.getItem('cv_theme') || 'monochrome';
      setTheme(savedTheme);

      const savedLayout = localStorage.getItem('cv_layout') || 'modern';
      setLayout(savedLayout);
      
      // Don't load any content or photo data
      console.log('Fresh template loaded - no persistent data');
    }

    function setupEditableElements() {
      cv.querySelectorAll('[data-editable]').forEach(el => {
        el.setAttribute('contenteditable', isEditing);
        if (isEditing) {
          el.addEventListener('input', debounce(saveData, 300));
          el.addEventListener('blur', saveData);
        }
      });
    }

    // Window management
    function openWindow(type) {
      // Close any open windows first
      closeWindow();
      
      // Show backdrop
      const backdrop = document.getElementById('windowBackdrop');
      backdrop.classList.add('active');
      
      // Show specific window
      const window = document.getElementById(type + 'Window');
      window.classList.add('active');
      
      // Update button state
      document.querySelectorAll('.selector-label').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function closeWindow() {
      // Hide backdrop
      const backdrop = document.getElementById('windowBackdrop');
      backdrop.classList.remove('active');
      
      // Hide all windows
      document.querySelectorAll('.selector-window').forEach(window => {
        window.classList.remove('active');
      });
      
      // Reset button states
      document.querySelectorAll('.selector-label').forEach(btn => btn.classList.remove('active'));
    }

    // Close window when clicking backdrop
    document.getElementById('windowBackdrop').addEventListener('click', closeWindow);

    // Dropdown management (legacy - now using windows)
    function toggleDropdown(type) {
      openWindow(type);
    }

    // Close dropdowns when clicking outside (legacy)
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.selector-group') && !e.target.closest('.selector-window')) {
        closeWindow();
      }
    });

    function setTheme(themeName) {
      htmlElement.setAttribute('data-theme', themeName);
      document.querySelectorAll('.theme-card').forEach(card => {
        card.classList.toggle('active', card.dataset.theme === themeName);
      });
      try {
        localStorage.setItem('cv_theme', themeName);
      } catch (e) {
        console.warn('Could not save theme');
      }
      // Close window after selection
      closeWindow();
    }

    function setLayout(layoutName) {
      htmlElement.setAttribute('data-layout', layoutName);
      document.querySelectorAll('.layout-card').forEach(card => {
        card.classList.toggle('active', card.dataset.layout === layoutName);
      });
      try {
        localStorage.setItem('cv_layout', layoutName);
      } catch (e) {
        console.warn('Could not save layout');
      }
      // Close window after selection
      closeWindow();
    }

    // Photo editing functionality
    function editPhoto() {
      if (photo.src && photo.src !== window.location.href && !photo.src.includes('data:image/svg+xml')) {
        // Photo exists, open editor with current photo
        fetch(photo.src)
          .then(response => response.blob())
          .then(blob => {
            const file = new File([blob], 'current-photo.jpg', { type: 'image/jpeg' });
            initPhotoCropper(file);
          })
          .catch(() => {
            // If fetch fails, trigger file upload
            photoInput.click();
          });
      } else {
        // No photo, trigger file upload
        photoInput.click();
      }
    }

    // Enhanced photo cropper functionality
    function initPhotoCropper(imageFile) {
      originalImage = new Image();
      const reader = new FileReader();
      
      reader.onload = function(e) {
        originalImage.src = e.target.result;
        cropImage.src = e.target.result;
        photoModal.classList.add('active');
        
        // Reset all settings
        resetCropSettings();
        
        // Initialize canvas
        cropCanvas = document.createElement('canvas');
        cropCtx = cropCanvas.getContext('2d');
        
        // Center the image when loaded
        originalImage.onload = function() {
          console.log('Original image loaded:', originalImage.naturalWidth, 'x', originalImage.naturalHeight);
          
          // Also set the crop image for display
          cropImage.onload = function() {
            console.log('Crop image ready for display');
            // Wait for both images to be fully loaded
            setTimeout(() => {
              centerImage();
              updateShapeOverlay(); // Initialize shape overlay
              updatePreviewShape(); // Apply initial shape
              console.log('Photo editor initialized successfully - unified mode');
            }, 300);
          };
        };
        
        originalImage.onerror = function() {
          console.error('Failed to load original image');
          alert('Failed to load the image. Please try again.');
        };
      };
      
      reader.readAsDataURL(imageFile);
    }

    function resetCropSettings() {
      currentScale = 1;
      currentX = 0;
      currentY = 0;
      currentRotation = 0;
      currentBrightness = 100;
      currentContrast = 100;
      currentShape = 'square';
      currentWidthScale = 100;
      currentHeightScale = 100;
      lockAspectRatio = true;
      currentSaturation = 100;
      currentVibrance = 0;
      currentSharpness = 0;
      currentVignette = 0;
      currentPreset = 'original';
      
      if (zoomSlider) zoomSlider.value = 100;
      if (rotationSlider) rotationSlider.value = 0;
      if (brightnessSlider) brightnessSlider.value = 100;
      if (contrastSlider) contrastSlider.value = 100;
      if (widthSlider) widthSlider.value = 100;
      if (heightSlider) heightSlider.value = 100;
      if (lockAspectRatioCheckbox) lockAspectRatioCheckbox.checked = true;
      if (saturationSlider) saturationSlider.value = 100;
      if (vibranceSlider) vibranceSlider.value = 0;
      if (sharpnessSlider) sharpnessSlider.value = 0;
      if (vignetteSlider) vignetteSlider.value = 0;
      
      // Reset preset buttons
      if (presetButtons && presetButtons.length) {
        presetButtons.forEach(btn => {
          btn.classList.remove('active');
          if (btn.dataset.preset === 'original') {
            btn.classList.add('active');
          }
        });
      }
      
      updateValueDisplays();
      updateShapeSelection();
      updatePreviewShape();
      updateShapeOverlay();
    }

    function centerImage() {
      if (!cropImage || !cropImage.complete) return;
      
      const areaRect = cropArea.getBoundingClientRect();
      
      // Calculate the scale to fit the image properly in the crop area
      const imgNaturalWidth = cropImage.naturalWidth;
      const imgNaturalHeight = cropImage.naturalHeight;
      const areaWidth = areaRect.width;
      const areaHeight = areaRect.height;
      
      // Calculate scale to fit image while maintaining aspect ratio
      const scaleX = areaWidth / imgNaturalWidth;
      const scaleY = areaHeight / imgNaturalHeight;
      const scale = Math.min(scaleX, scaleY) * 0.8; // 80% to leave some margin
      
      // Set the image size
      cropImage.style.width = imgNaturalWidth * scale + 'px';
      cropImage.style.height = imgNaturalHeight * scale + 'px';
      
      // Center the image
      const imgWidth = cropImage.offsetWidth;
      const imgHeight = cropImage.offsetHeight;
      
      currentX = (areaWidth - imgWidth) / 2;
      currentY = (areaHeight - imgHeight) / 2;
      
      updateImageTransform();
    }

    function updateImageTransform() {
      if (!cropImage) return;
      
      // Create comprehensive filter string
      const filters = [
        `brightness(${currentBrightness}%)`,
        `contrast(${currentContrast}%)`,
        `saturate(${currentSaturation}%)`,
        currentSharpness !== 0 ? `contrast(${100 + currentSharpness}%)` : '',
        currentVignette > 0 ? `sepia(${currentVignette * 0.3}%)` : ''
      ].filter(f => f).join(' ');
      
      const scaleX = currentScale * (currentWidthScale / 100);
      const scaleY = currentScale * (currentHeightScale / 100);
      
      cropImage.style.transform = `translate(${currentX}px, ${currentY}px) scaleX(${scaleX}) scaleY(${scaleY}) rotate(${currentRotation}deg)`;
      cropImage.style.filter = filters;
      
      // Add vibrance effect using box-shadow for artistic effect
      if (currentVibrance !== 0) {
        const vibranceIntensity = Math.abs(currentVibrance) / 100;
        const vibranceColor = currentVibrance > 0 ? 'rgba(255, 100, 100, 0.1)' : 'rgba(100, 100, 255, 0.1)';
        cropImage.style.boxShadow = `inset 0 0 50px ${vibranceIntensity * 20}px ${vibranceColor}`;
      } else {
        cropImage.style.boxShadow = '';
      }
      
      // Update the shape preview in real-time
      updatePreviewShape();
      
      // Update the shape overlay
      updateShapeOverlay();
    }

    function updatePreview() {
      // In unified mode, the main image IS the preview
      // Just update the shape overlay to show the final crop area
      updateShapeOverlay();
    }

    function updateShapeOverlay() {
      if (!shapeOverlay) return;
      
      // Apply current shape to the overlay
      shapeOverlay.className = 'shape-overlay';
      
      switch(currentShape) {
        case 'circle':
          shapeOverlay.classList.add('circle');
          break;
        case 'rounded':
          shapeOverlay.classList.add('rounded');
          break;
        case 'hexagon':
          shapeOverlay.classList.add('hexagon');
          break;
        default: // square
          // Default styling already applied
          break;
      }
    }

    function updatePreviewShape() {
      // Update the main image shape in real-time
      const image = cropImage;
      if (!image) return;
      
      switch(currentShape) {
        case 'circle':
          image.style.borderRadius = '50%';
          image.style.clipPath = 'none';
          break;
        case 'rounded':
          image.style.borderRadius = '20px';
          image.style.clipPath = 'none';
          break;
        case 'hexagon':
          image.style.borderRadius = '0';
          image.style.clipPath = 'polygon(30% 0%, 70% 0%, 100% 50%, 70% 100%, 30% 100%, 0% 50%)';
          break;
        default: // square
          image.style.borderRadius = '8px';
          image.style.clipPath = 'none';
      }
      
      updateShapeOverlay();
    }

    function updateShapeSelection() {
      if (!shapeOptions) return;
      shapeOptions.forEach(option => {
        option.classList.toggle('active', option.dataset.shape === currentShape);
      });
    }

    function updateValueDisplays() {
      if (zoomValue) zoomValue.textContent = Math.round(currentScale * 100) + '%';
      if (rotationValue) rotationValue.textContent = currentRotation + '°';
      if (brightnessValue) brightnessValue.textContent = currentBrightness + '%';
      if (contrastValue) contrastValue.textContent = currentContrast + '%';
      if (widthValue) widthValue.textContent = currentWidthScale + '%';
      if (heightValue) heightValue.textContent = currentHeightScale + '%';
      if (saturationValue) saturationValue.textContent = currentSaturation + '%';
      if (vibranceValue) vibranceValue.textContent = currentVibrance + '%';
      if (sharpnessValue) sharpnessValue.textContent = currentSharpness + '%';
      if (vignetteValue) vignetteValue.textContent = currentVignette + '%';
    }

    function closeCropModal() {
      photoModal.classList.remove('active');
      cropImage.src = '';
      originalImage = null;
      if (cropCanvas) {
        cropCanvas = null;
        cropCtx = null;
      }
    }

    function applyCropSettings() {
      if (!originalImage || !originalImage.complete) return;
      
      try {
        // Create final canvas
        const finalCanvas = document.createElement('canvas');
        const finalCtx = finalCanvas.getContext('2d');
        
        // Set canvas size for final output
        finalCanvas.width = 300;
        finalCanvas.height = 300;
        
        // Save context and apply transformations
        finalCtx.save();
        finalCtx.translate(150, 150); // Center of canvas
        finalCtx.rotate(currentRotation * Math.PI / 180);
        finalCtx.filter = `brightness(${currentBrightness}%) contrast(${currentContrast}%)`;
        
        // Calculate the final size based on scale and width/height scaling
        const finalWidth = 300 * currentScale * (currentWidthScale / 100);
        const finalHeight = 300 * currentScale * (currentHeightScale / 100);
        
        // Draw the original image with all transformations applied
        finalCtx.drawImage(originalImage, -finalWidth / 2, -finalHeight / 2, finalWidth, finalHeight);
        
        // Restore context
        finalCtx.restore();
        
        // Apply shape clipping for final result
        const shapedCanvas = document.createElement('canvas');
        const shapedCtx = shapedCanvas.getContext('2d');
        shapedCanvas.width = 300;
        shapedCanvas.height = 300;
        
        // Create clipping path based on shape
        shapedCtx.save();
        switch(currentShape) {
          case 'circle':
            shapedCtx.arc(150, 150, 150, 0, 2 * Math.PI);
            break;
          case 'rounded':
            roundRect(shapedCtx, 0, 0, 300, 300, 40);
            break;
          case 'hexagon':
            hexagon(shapedCtx, 150, 150, 140);
            break;
          default: // square
            shapedCtx.rect(0, 0, 300, 300);
        }
        shapedCtx.clip();
        shapedCtx.drawImage(finalCanvas, 0, 0);
        shapedCtx.restore();
        
        // Apply to photo
        const croppedDataURL = shapedCanvas.toDataURL('image/jpeg', 0.9);
        photo.src = croppedDataURL;
        
        // Apply shape to photo element
        switch(currentShape) {
          case 'circle':
            photo.style.borderRadius = '50%';
            photo.style.clipPath = 'none';
            break;
          case 'rounded':
            photo.style.borderRadius = '20px';
            photo.style.clipPath = 'none';
            break;
          case 'hexagon':
            photo.style.borderRadius = '0';
            photo.style.clipPath = 'polygon(30% 0%, 70% 0%, 100% 50%, 70% 100%, 30% 100%, 0% 50%)';
            break;
          default: // square
            photo.style.borderRadius = '16px';
            photo.style.clipPath = 'none';
        }
        
        closeCropModal();
      } catch (error) {
        console.error('Failed to apply crop settings:', error);
        alert('Failed to process image. Please try again.');
      }
    }

    // Helper functions for shapes
    function roundRect(ctx, x, y, width, height, radius) {
      ctx.beginPath();
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + width - radius, y);
      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
      ctx.lineTo(x + width, y + height - radius);
      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
      ctx.lineTo(x + radius, y + height);
      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
      ctx.lineTo(x, y + radius);
      ctx.quadraticCurveTo(x, y, x + radius, y);
      ctx.closePath();
    }

    function hexagon(ctx, x, y, radius) {
      ctx.beginPath();
      for (let i = 0; i < 6; i++) {
        const angle = (i * Math.PI) / 3;
        const xPos = x + radius * Math.cos(angle);
        const yPos = y + radius * Math.sin(angle);
        if (i === 0) {
          ctx.moveTo(xPos, yPos);
        } else {
          ctx.lineTo(xPos, yPos);
        }
      }
      ctx.closePath();
    }

    function toggleEditing() {
      isEditing = !isEditing;
      cv.classList.toggle('editing', isEditing);
      toggleBtn.innerHTML = isEditing ? '🔓 Edit Mode' : '🔒 View Mode';
      setupEditableElements();
    }

    function exportPDF() {
      // Hide all editing elements
      const editingElements = document.querySelectorAll('.hint, .remove-btn, #controls .btn, .photo-modal');
      editingElements.forEach(el => el.style.display = 'none');
      
      // Hide any potential header/footer elements
      const unwantedElements = document.querySelectorAll('header, footer, .no-print, .print-hide');
      unwantedElements.forEach(el => el.style.display = 'none');
      
      // Temporarily disable editing mode
      const wasEditing = isEditing;
      if (isEditing) {
        cv.classList.remove('editing');
        cv.querySelectorAll('[data-editable]').forEach(el => {
          el.setAttribute('contenteditable', 'false');
        });
      }

      // Add clean print styles
      const printStyles = document.createElement('style');
      printStyles.innerHTML = `
        @media print {
          @page {
            size: A4;
            margin: 12mm;
          }
          html, body {
            background: white !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
          .photo-modal {
            display: none !important;
          }
        }
      `;
      document.head.appendChild(printStyles);

      // Print with a slight delay to ensure styles are applied
      setTimeout(() => {
        window.print();
      }, 100);

      // Restore everything after printing
      setTimeout(() => {
        editingElements.forEach(el => el.style.display = '');
        unwantedElements.forEach(el => el.style.display = '');
        document.head.removeChild(printStyles);
        
        if (wasEditing) {
          cv.classList.add('editing');
          setupEditableElements();
        }
      }, 1000);
    }

    function resetCV() {
      if (confirm('Are you sure you want to reset the entire CV? This will reload the page with fresh content.')) {
        // Clear only theme/layout localStorage, keep fresh start behavior
        localStorage.removeItem('cv_theme');
        localStorage.removeItem('cv_layout');
        location.reload();
      }
    }

    // Photo cropper functionality - removed duplicate

    // Duplicate function removed - updateImageTransform is above

    // Duplicate function removed

    // Duplicate function removed

    // Photo cropper event listeners
    let startX, startY;

    cropImage.addEventListener('mousedown', (e) => {
      isDragging = true;
      startX = e.clientX - currentX;
      startY = e.clientY - currentY;
      e.preventDefault();
    });

    document.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      
      currentX = e.clientX - startX;
      currentY = e.clientY - startY;
      updateImageTransform();
    });

    document.addEventListener('mouseup', () => {
      isDragging = false;
    });

    // Touch events for mobile
    cropImage.addEventListener('touchstart', (e) => {
      isDragging = true;
      const touch = e.touches[0];
      startX = touch.clientX - currentX;
      startY = touch.clientY - currentY;
      e.preventDefault();
    });

    document.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      
      const touch = e.touches[0];
      currentX = touch.clientX - startX;
      currentY = touch.clientY - startY;
      updateImageTransform();
      e.preventDefault();
    });

    document.addEventListener('touchend', () => {
      isDragging = false;
    });

    // Control sliders
    if (zoomSlider) {
      zoomSlider.addEventListener('input', (e) => {
        currentScale = e.target.value / 100;
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (rotationSlider) {
      rotationSlider.addEventListener('input', (e) => {
        currentRotation = parseInt(e.target.value);
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (brightnessSlider) {
      brightnessSlider.addEventListener('input', (e) => {
        currentBrightness = parseInt(e.target.value);
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (contrastSlider) {
      contrastSlider.addEventListener('input', (e) => {
        currentContrast = parseInt(e.target.value);
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (widthSlider) {
      widthSlider.addEventListener('input', (e) => {
        currentWidthScale = parseInt(e.target.value);
        
        // If aspect ratio is locked, update height as well
        if (lockAspectRatio) {
          currentHeightScale = currentWidthScale;
          if (heightSlider) heightSlider.value = currentWidthScale;
        }
        
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (heightSlider) {
      heightSlider.addEventListener('input', (e) => {
        currentHeightScale = parseInt(e.target.value);
        
        // If aspect ratio is locked, update width as well
        if (lockAspectRatio) {
          currentWidthScale = currentHeightScale;
          if (widthSlider) widthSlider.value = currentHeightScale;
        }
        
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (lockAspectRatioCheckbox) {
      lockAspectRatioCheckbox.addEventListener('change', (e) => {
        lockAspectRatio = e.target.checked;
        
        // If locking aspect ratio, sync height to width
        if (lockAspectRatio) {
          currentHeightScale = currentWidthScale;
          if (heightSlider) heightSlider.value = currentWidthScale;
          updateValueDisplays();
        }
      });
    }

    // Rotation buttons
    if (rotateLeft) {
      rotateLeft.addEventListener('click', () => {
        currentRotation = Math.max(-180, currentRotation - 15);
        if (rotationSlider) rotationSlider.value = currentRotation;
        updateImageTransform();
        updateValueDisplays();
      });
    }

    if (rotateRight) {
      rotateRight.addEventListener('click', () => {
        currentRotation = Math.min(180, currentRotation + 15);
        if (rotationSlider) rotationSlider.value = currentRotation;
        updateImageTransform();
        updateValueDisplays();
      });
    }

    // Shape selection
    if (shapeOptions) {
      shapeOptions.forEach(option => {
        option.addEventListener('click', () => {
          currentShape = option.dataset.shape;
          updateShapeSelection();
          updatePreviewShape();
          updateShapeOverlay();
        });
      });
    }

    // Mouse wheel zoom
    if (cropArea) {
      cropArea.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY > 0 ? -10 : 10;
        const newZoom = Math.max(10, Math.min(1000, parseInt(zoomSlider?.value || 100) + delta));
        if (zoomSlider) zoomSlider.value = newZoom;
        currentScale = newZoom / 100;
        updateImageTransform();
        updateValueDisplays();
      });
    }

    // Modal controls
    if (closeCrop) closeCrop.addEventListener('click', closeCropModal);
    if (cancelCrop) cancelCrop.addEventListener('click', closeCropModal);
    if (applyCrop) applyCrop.addEventListener('click', applyCropSettings);
    if (resetCrop) {
      resetCrop.addEventListener('click', () => {
        resetCropSettings();
        setTimeout(() => {
          centerImage();
        }, 100);
      });
    }

    // Close modal on background click
    if (photoModal) {
      photoModal.addEventListener('click', (e) => {
        if (e.target === photoModal) {
          closeCropModal();
        }
      });
    }

    // Add/Remove functions
    window.removeItem = function(btn) {
      btn.closest('.removable').remove();
      // Don't save - keep it temporary
    };

    window.addContact = function() {
      const contactList = document.getElementById('contactList');
      const newItem = document.createElement('li');
      newItem.className = 'info-item removable';
      newItem.innerHTML = `
        <span class="info-icon">📧</span>
        <span data-editable contenteditable="${isEditing}">New contact info</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      contactList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addSkill = function() {
      const skillsList = document.getElementById('skillsList');
      const newSkill = document.createElement('span');
      newSkill.className = 'skill-pill removable';
      newSkill.innerHTML = `
        <span data-editable contenteditable="${isEditing}">New Skill</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      skillsList.appendChild(newSkill);
      if (isEditing) {
        newSkill.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newSkill.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addCertification = function() {
      const certsList = document.getElementById('certsList');
      const newItem = document.createElement('li');
      newItem.className = 'info-item removable';
      newItem.innerHTML = `
        <span class="info-icon">🏆</span>
        <span data-editable contenteditable="${isEditing}">New certification</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      certsList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addLanguage = function() {
      const languagesList = document.getElementById('languagesList');
      const newItem = document.createElement('div');
      newItem.className = 'language-item removable';
      newItem.innerHTML = `
        <div class="language-header">
          <span data-editable contenteditable="${isEditing}">New Language</span>
          <span data-editable contenteditable="${isEditing}">Level</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 70%;"></div>
        </div>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      languagesList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelectorAll('[data-editable]').forEach(el => {
          el.addEventListener('input', debounce(saveData, 300));
          el.addEventListener('blur', saveData);
        });
      }
    };

    window.addPersonalInfo = function() {
      const personalList = document.getElementById('personalList');
      const newItem = document.createElement('li');
      newItem.className = 'info-item removable';
      newItem.innerHTML = `
        <span class="info-icon">ℹ️</span>
        <span data-editable contenteditable="${isEditing}">New personal info</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      personalList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addAchievement = function(buttonElement) {
      // Find the parent timeline-item that contains this button
      const jobElement = buttonElement.closest('.timeline-item');
      if (!jobElement) {
        console.error('Could not find parent timeline-item');
        return;
      }
      
      const achievementsList = jobElement.querySelector('.job-achievements');
      if (!achievementsList) {
        console.error('Could not find job-achievements list');
        return;
      }
      
      const newItem = document.createElement('li');
      newItem.className = 'removable';
      newItem.innerHTML = `<span data-editable contenteditable="${isEditing}">New achievement or responsibility</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>`;
      achievementsList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addSimpleAchievement = function() {
      const achievementsList = document.getElementById('achievementsList');
      const newItem = document.createElement('li');
      newItem.className = 'removable';
      newItem.innerHTML = `<span data-editable contenteditable="${isEditing}">New achievement</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>`;
      achievementsList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addResponsibility = function() {
      const responsibilitiesList = document.getElementById('responsibilitiesList');
      const newItem = document.createElement('li');
      newItem.className = 'removable';
      newItem.innerHTML = `<span data-editable contenteditable="${isEditing}">New professional responsibility</span>
        <button class="remove-btn" onclick="removeItem(this)">×</button>`;
      responsibilitiesList.appendChild(newItem);
      if (isEditing) {
        newItem.querySelector('[data-editable]').addEventListener('input', debounce(saveData, 300));
        newItem.querySelector('[data-editable]').addEventListener('blur', saveData);
      }
    };

    window.addReference = function() {
      const referencesList = document.getElementById('referencesList');
      const newReference = document.createElement('div');
      newReference.className = 'card removable';
      newReference.innerHTML = `
        <h3 class="card-title" data-editable contenteditable="${isEditing}">Reference Name</h3>
        <div class="card-subtitle" data-editable contenteditable="${isEditing}">Position Title</div>
        <div class="card-meta" data-editable contenteditable="${isEditing}">Organization</div>
        <div class="card-desc" data-editable contenteditable="${isEditing}">
          Phone: <span data-editable contenteditable="${isEditing}">+XXX X XXX XXXX</span><br>
          Email: <span data-editable contenteditable="${isEditing}">email@domain.com</span><br>
          Relationship: <span data-editable contenteditable="${isEditing}">Professional relationship</span>
        </div>
        <button class="remove-btn" onclick="removeItem(this)">×</button>
      `;
      referencesList.appendChild(newReference);
      if (isEditing) {
        newReference.querySelectorAll('[data-editable]').forEach(el => {
          el.addEventListener('input', debounce(saveData, 300));
          el.addEventListener('blur', saveData);
        });
      }
    };

    function addJob() {
      const template = document.getElementById('jobTemplate');
      const experienceList = document.getElementById('experienceList');
      const newJob = template.content.cloneNode(true);
      
      if (isEditing) {
        newJob.querySelectorAll('[data-editable]').forEach(el => {
          el.setAttribute('contenteditable', 'true');
          el.addEventListener('input', debounce(saveData, 300));
          el.addEventListener('blur', saveData);
        });
      }
      
      experienceList.appendChild(newJob);
    }

    function addEducation() {
      const template = document.getElementById('educationTemplate');
      const educationList = document.getElementById('educationList');
      const newEducation = template.content.cloneNode(true);
      
      if (isEditing) {
        newEducation.querySelectorAll('[data-editable]').forEach(el => {
          el.setAttribute('contenteditable', 'true');
          el.addEventListener('input', debounce(saveData, 300));
          el.addEventListener('blur', saveData);
        });
      }
      
      educationList.appendChild(newEducation);
    }

    function handlePhotoUpload(event) {
      const file = event.target.files[0];
      if (!file) return;

      if (!file.type.startsWith('image/')) {
        alert('Please select an image file.');
        return;
      }

      if (file.size > 5 * 1024 * 1024) {
        alert('Image size must be less than 5MB.');
        return;
      }

      // Open photo cropper
      initPhotoCropper(file);
      
      // Clear the input so the same file can be selected again
      event.target.value = '';
    }

    // Event listeners
    toggleBtn.addEventListener('click', toggleEditing);
    exportBtn.addEventListener('click', exportPDF);
    resetBtn.addEventListener('click', resetCV);
    addJobBtn.addEventListener('click', addJob);
    addEducationBtn.addEventListener('click', addEducation);
    photoBtn.addEventListener('click', () => photoInput.click());
    photoInput.addEventListener('change', handlePhotoUpload);

    // Theme selection
    document.addEventListener('click', (e) => {
      if (e.target.closest('.theme-card')) {
        const themeCard = e.target.closest('.theme-card');
        setTheme(themeCard.dataset.theme);
      }
    });

    // Layout selection
    document.addEventListener('click', (e) => {
      if (e.target.closest('.layout-card')) {
        const layoutCard = e.target.closest('.layout-card');
        setLayout(layoutCard.dataset.layout);
      }
    });

    // Print event handlers
    window.addEventListener('beforeprint', () => {
      document.querySelectorAll('.hint, .remove-btn, .photo-modal').forEach(el => {
        el.style.display = 'none';
      });
    });

    window.addEventListener('afterprint', () => {
      document.querySelectorAll('.hint, .remove-btn').forEach(el => {
        el.style.display = '';
      });
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
          case 'p':
            e.preventDefault();
            exportPDF();
            break;
          case 's':
            e.preventDefault();
            // saveData(); // Disabled for fresh starts
            break;
          case 'e':
            e.preventDefault();
            toggleEditing();
            break;
        }
      }
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Set default photo if none exists
      if (!photo.src || photo.src === window.location.href) {
        photo.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNjY3ZWVhO3N0b3Atb3BhY2l0eToxIiAvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MSIgLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0idXJsKCNncmFkKSIvPjxjaXJjbGUgY3g9IjUwIiBjeT0iMzUiIHI9IjE1IiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC44Ii8+PHBhdGggZD0iTTIwIDc1QzMwIDY1IDQwIDY1IDUwIDY1QzYwIDY1IDcwIDY1IDgwIDc1Vjg1SDIwVjc1WiIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuOCIvPjwvc3ZnPg==';
      }

      loadData(); // Only loads theme/layout preferences
      setupEditableElements();

      // Add smooth transitions for layout changes
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.type === 'attributes' && mutation.attributeName === 'data-layout') {
            cv.style.transition = 'all 0.5s ease';
            setTimeout(() => {
              cv.style.transition = '';
            }, 500);
          }
        });
      });

      observer.observe(htmlElement, {
        attributes: true,
        attributeFilter: ['data-layout', 'data-theme']
      });
    });

    // Auto-save improvements (disabled for fresh starts)
    let saveTimeout;
    const autoSave = () => {
      clearTimeout(saveTimeout);
      // saveTimeout = setTimeout(saveData, 1000); // Disabled
    };

    // Enhanced focus management for better UX
    cv.addEventListener('focusin', (e) => {
      if (e.target.matches('[data-editable]')) {
        e.target.style.transition = 'all 0.3s ease';
      }
    });

    cv.addEventListener('focusout', (e) => {
      if (e.target.matches('[data-editable]')) {
        setTimeout(() => {
          e.target.style.transition = '';
        }, 300);
      }
    });

    // Performance optimization for large content
    const intersectionObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.willChange = 'transform';
        } else {
          entry.target.style.willChange = 'auto';
        }
      });
    });

    // Observe animated elements
    document.querySelectorAll('.card, .timeline-item, .skill-pill').forEach(el => {
      intersectionObserver.observe(el);
    });

    // Enhanced Photo Editor Initialization
    function initEnhancedPhotoEditor() {
      // Add event listeners for new controls
      // Collapsible sections
      document.querySelectorAll('.side-section .collapse-toggle').forEach(toggle => {
        toggle.addEventListener('click', () => {
          const section = toggle.closest('.side-section');
          section.classList.toggle('collapsed');
        });
      });
      if (saturationSlider) {
        saturationSlider.addEventListener('input', (e) => {
          currentSaturation = parseInt(e.target.value);
          updateImageTransform();
          updateValueDisplays();
        });
      }

      if (vibranceSlider) {
        vibranceSlider.addEventListener('input', (e) => {
          currentVibrance = parseInt(e.target.value);
          updateImageTransform();
          updateValueDisplays();
        });
      }

      if (sharpnessSlider) {
        sharpnessSlider.addEventListener('input', (e) => {
          currentSharpness = parseInt(e.target.value);
          updateImageTransform();
          updateValueDisplays();
        });
      }

      if (vignetteSlider) {
        vignetteSlider.addEventListener('input', (e) => {
          currentVignette = parseInt(e.target.value);
          updateImageTransform();
          updateValueDisplays();
        });
      }

      // Preset filters (filter chips)
      if (presetButtons && presetButtons.length) {
        presetButtons.forEach(btn => {
          btn.addEventListener('click', () => {
            applyPreset(btn.dataset.preset);
            presetButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
          });
        });
      }
    }

    function applyPreset(preset) {
      currentPreset = preset;
      
      const presets = {
        original: { brightness: 100, contrast: 100, saturation: 100, vibrance: 0, vignette: 0 },
        vintage: { brightness: 110, contrast: 85, saturation: 80, vibrance: 15, vignette: 30 },
        cinematic: { brightness: 95, contrast: 120, saturation: 90, vibrance: 10, vignette: 20 },
        warm: { brightness: 105, contrast: 100, saturation: 110, vibrance: 20, vignette: 0 },
        cool: { brightness: 100, contrast: 105, saturation: 85, vibrance: -10, vignette: 0 },
        dramatic: { brightness: 90, contrast: 140, saturation: 120, vibrance: 25, vignette: 40 },
        professional: { brightness: 102, contrast: 108, saturation: 95, vibrance: 5, vignette: 0 },
        artistic: { brightness: 110, contrast: 90, saturation: 130, vibrance: 30, vignette: 25 }
      };

      const settings = presets[preset];
      if (settings) {
        currentBrightness = settings.brightness;
        currentContrast = settings.contrast;
        currentSaturation = settings.saturation;
        currentVibrance = settings.vibrance;
        currentVignette = settings.vignette;

        // Update sliders
        if (brightnessSlider) brightnessSlider.value = currentBrightness;
        if (contrastSlider) contrastSlider.value = currentContrast;
        if (saturationSlider) saturationSlider.value = currentSaturation;
        if (vibranceSlider) vibranceSlider.value = currentVibrance;
        if (vignetteSlider) vignetteSlider.value = currentVignette;

        updateImageTransform();
        updateValueDisplays();
      }
    }

    // Initialize loading system
    function initLoadingSystem() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      
      // Simulate loading
      setTimeout(() => {
        if (loadingOverlay) {
          loadingOverlay.classList.add('hidden');
        }
      }, 2000);
    }

    // Enhanced initialization
    document.addEventListener('DOMContentLoaded', () => {
      initLoadingSystem();
      initEnhancedPhotoEditor();
    });

    // Make functions global
    window.openWindow = openWindow;
    window.closeWindow = closeWindow;
    window.editPhoto = editPhoto;
    window.toggleDropdown = toggleDropdown;
    console.log('📋 Available themes:', ['ocean', 'sunset', 'forest', 'royal', 'aurora', 'cyber', 'midnight', 'coral', 'emerald', 'golden', 'lavender', 'monochrome', 'neon', 'executive', 'charcoal', 'steel', 'bronze', 'navy', 'carbon', 'military', 'burgundy']);
    console.log('📐 Available layouts:', ['modern', 'compact', 'centered', 'executive', 'minimal', 'two-column', 'split', 'creative', 'timeline', 'magazine', 'grid']);
    console.log('🔄 Fresh start mode: Content resets on every page refresh');
    console.log('📷 Enhanced photo editor: Upload, crop, rotate, adjust brightness/contrast, width/height scaling, advanced filters, and AI presets');
    console.log('🎛️ Dropdown controls: Click theme/layout buttons to see all options');
    console.log('✨ New features: Free transform, advanced enhancements, preset filters, loading system');
    console.log('👤 Current user: imohmia');

  </script>
</body>
</html>
